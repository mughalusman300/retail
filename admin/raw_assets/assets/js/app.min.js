/*
Template Name: STUDIO - Responsive Bootstrap 5 Admin Template
Version: 4.0.0
Author: Sean Ngu
	----------------------------
		APPS CONTENT TABLE
	----------------------------

	<!-- ======== GLOBAL SCRIPT SETTING ======== -->
  01. Global Variable
  02. Handle Scrollbar
  03. Handle Sidebar Menu
  04. Handle Sidebar Minify
  05. Handle Sidebar Minify Float Menu
  06. Handle Dropdown Close Option
  07. Handle Card - Remove / Reload / Collapse / Expand
  08. Handle Tooltip & Popover Activation
  09. Handle Scroll to Top Button Activation
  10. Handle hexToRgba
  11. Handle Scroll to
  12. Handle Theme Panel Expand
  13. Handle Theme Page Control
  14. Handle Enable Tooltip & Popover
	
	<!-- ======== APPLICATION SETTING ======== -->
	Application Controller
*/



/* 01. Global Variable
------------------------------------------------ */
var app = {
	class: 'app',
	isMobile: ((/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) || window.innerWidth < 992),
	header: {
		class: 'app-header'
	},
	sidebar: {
		class: 'app-sidebar',
		menuClass: 'menu',
		menuItemClass: 'menu-item',
		menuItemHasSubClass: 'has-sub',
		menuLinkClass: 'menu-link',
		menuSubmenuClass: 'menu-submenu',
		menuExpandClass: 'expand',
		minify: {
			toggledClass: 'app-sidebar-minified',
			localStorage: 'appSidebarMinified',
			toggleAttr: 'data-toggle="sidebar-minify"'
		},
		mobile: {
			toggledClass: 'app-sidebar-mobile-toggled',
			closedClass: 'app-sidebar-mobile-closed',
			dismissAttr: 'data-dismiss="sidebar-mobile"',
			toggleAttr: 'data-toggle="sidebar-mobile"',
		},
		scrollBar: {
			localStorage: 'appSidebarScrollPosition',
			dom: '',
		}
	},
	floatSubmenu: {
		id: 'app-float-submenu',
		dom: '',
		timeout: '',
		class: 'app-float-submenu',
		container: {
			class: 'app-float-submenu-container'
		},
		overflow: {
			class: 'overflow-scroll mh-100vh'
		}
	},
	themePanel: {
		class: 'theme-panel',
		toggleAttr: 'data-click="theme-panel-expand"',
		expandCookie: 'theme-panel',
		expandCookieValue: 'expand',
		activeClass: 'active',
		themeList: {
			class: 'theme-list',
			toggleAttr: 'data-theme',
			activeClass: 'active',
			cookieName: 'theme',
			onChangeEvent: 'theme-reload'
		},
		darkMode: {
			class: 'dark-mode',
			inputName: 'app-theme-dark-mode',
			cookieName: 'dark-mode'
		}
	},
	animation: { 
		speed: 300 
	},
	scrollBar: {
		attr: 'data-scrollbar="true"',
		heightAttr: 'data-height',
		skipMobileAttr: 'data-skip-mobile="true"',
		wheelPropagationAttr: 'data-wheel-propagation'
	},
	scrollTo: {
		toggleAttr: 'data-toggle="scroll-to"',
		targetAttr: 'data-target'
	},
	scrollTopButton: {
		toggleAttr: 'data-click="scroll-top"',
		showClass: 'show'
	},
	card: { 
		class: 'card',
		expand: {
			toggleAttr: 'data-toggle="card-expand"',
			status: false,
			class: 'card-expand',
			tooltipText: 'Expand / Compress'
		}
	},
	tooltip: {
		toggleAttr: 'data-bs-toggle="tooltip"'
	},
	popover: {
		toggleAttr: 'data-bs-toggle="popover"'
	},
	dismissClass: {
		toggleAttr: 'data-dismiss-class',
		targetAttr: 'data-dismiss-target'
	},
	toggleClass: {
		toggleAttr: 'data-toggle-class',
		targetAttr: 'data-toggle-target'
	},
	font: { },
	color: { },
	variablePrefix: 'bs-',
	variableFontList: ['body-font-family', 'body-font-size', 'body-font-weight', 'body-line-height'],
	variableColorList: [
		'theme', 'theme-rgb', 'theme-color', 'theme-color-rgb',
		'default', 'default-rgb',
		'primary', 'primary-rgb', 'primary-bg-subtle', 'primary-text', 'primary-border-subtle',
		'secondary', 'secondary-rgb', 'secondary-bg-subtle', 'secondary-text', 'secondary-border-subtle',
		'success', 'success-rgb', 'success-bg-subtle', 'success-text', 'success-border-subtle',
		'warning', 'warning-rgb', 'warning-bg-subtle', 'warning-text', 'warning-border-subtle',
		'info', 'info-rgb', 'info-bg-subtle', 'info-text', 'info-border-subtle',
		'danger', 'danger-rgb', 'danger-bg-subtle', 'danger-text', 'danger-border-subtle',
		'light', 'light-rgb', 'light-bg-subtle', 'light-text', 'light-border-subtle',
		'dark', 'dark-rgb', 'dark-bg-subtle', 'dark-text', 'dark-border-subtle',
		'white', 'white-rgb',
		'black', 'black-rgb',
		'teal', 'teal-rgb',
		'indigo', 'indigo-rgb', 
		'purple', 'purple-rgb',
		'yellow', 'yellow-rgb',
		'pink', 'pink-rgb',
		'cyan', 'cyan-rgb',
		'gray-100', 'gray-200', 'gray-300', 'gray-400', 'gray-500',  'gray-600', 'gray-700', 'gray-800', 'gray-900', 
		'gray-100-rgb', 'gray-200-rgb', 'gray-300-rgb', 'gray-400-rgb', 'gray-500-rgb',  'gray-600-rgb', 'gray-700-rgb', 'gray-800-rgb', 'gray-900-rgb', 
		'muted', 'muted-rgb', 'emphasis-color', 'emphasis-color-rgb',
		'component-bg', 'component-bg-rgb', 'component-color', 'component-color-rgb',
		'body-bg', 'body-bg-rgb', 'body-color', 'body-color-rgb',
		'heading-color', 
		'secondary-color', 'secondary-color-rgb', 'secondary-bg', 'secondary-bg-rgb',
		'tertiary-color', 'tertiary-color-rgb', 'tertiary-bg', 'tertiary-bg-rgb',
		'link-color', 'link-color-rgb', 'link-hover-color', 'link-hover-color-rgb', 
		'border-color', 'border-color-translucent'
	],
}

var slideUp = function(elm, duration = app.animation.speed) {
	if (!elm.classList.contains('transitioning')) {
		elm.classList.add('transitioning');
		elm.style.transitionProperty = 'height, margin, padding';
		elm.style.transitionDuration = duration + 'ms';
		elm.style.boxSizing = 'border-box';
		elm.style.height = elm.offsetHeight + 'px';
		elm.offsetHeight;
		elm.style.overflow = 'hidden';
		elm.style.height = 0;
		elm.style.paddingTop = 0;
		elm.style.paddingBottom = 0;
		elm.style.marginTop = 0;
		elm.style.marginBottom = 0;
		window.setTimeout( () => {
			elm.style.display = 'none';
			elm.style.removeProperty('height');
			elm.style.removeProperty('padding-top');
			elm.style.removeProperty('padding-bottom');
			elm.style.removeProperty('margin-top');
			elm.style.removeProperty('margin-bottom');
			elm.style.removeProperty('overflow');
			elm.style.removeProperty('transition-duration');
			elm.style.removeProperty('transition-property');
			elm.classList.remove('transitioning');
		}, duration);
	}
};

var slideDown = function(elm, duration = app.animation.speed) {
	if (!elm.classList.contains('transitioning')) {
		elm.classList.add('transitioning');
		elm.style.removeProperty('display');
		let display = window.getComputedStyle(elm).display;
		if (display === 'none') display = 'block';
		elm.style.display = display;
		let height = elm.offsetHeight;
		elm.style.overflow = 'hidden';
		elm.style.height = 0;
		elm.style.paddingTop = 0;
		elm.style.paddingBottom = 0;
		elm.style.marginTop = 0;
		elm.style.marginBottom = 0;
		elm.offsetHeight;
		elm.style.boxSizing = 'border-box';
		elm.style.transitionProperty = "height, margin, padding";
		elm.style.transitionDuration = duration + 'ms';
		elm.style.height = height + 'px';
		elm.style.removeProperty('padding-top');
		elm.style.removeProperty('padding-bottom');
		elm.style.removeProperty('margin-top');
		elm.style.removeProperty('margin-bottom');
		window.setTimeout( () => {
			elm.style.removeProperty('height');
			elm.style.removeProperty('overflow');
			elm.style.removeProperty('transition-duration');
			elm.style.removeProperty('transition-property');
			elm.classList.remove('transitioning');
		}, duration);
	}
};

var slideToggle = function(elm, duration = app.animation.speed) {
	if (window.getComputedStyle(elm).display === 'none') {
		return slideDown(elm, duration);
	} else {
		return slideUp(elm, duration);
	}
};

var setCookie = function(cookieName, cookieValue) {
	var now = new Date();
  var time = now.getTime();
  var expireTime = time + 1000*36000;
  now.setTime(expireTime);
  document.cookie = cookieName + '='+ cookieValue +';expires='+now.toUTCString()+';path=/';
};

var getCookie = function(cookieName) {
  let name = cookieName + "=";
  let decodedCookie = decodeURIComponent(document.cookie);
  let ca = decodedCookie.split(';');
  for(let i = 0; i <ca.length; i++) {
    let c = ca[i];
    while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (c.indexOf(name) == 0) {
      return c.substring(name.length, c.length);
    }
  }
  return "";
};


/* 02. Handle Scrollbar
------------------------------------------------ */
var handleScrollbar = function() {
	"use strict";
	
	var elms = document.querySelectorAll('['+ app.scrollBar.attr +']');
		
	for (var i = 0; i < elms.length; i++) {
		generateScrollbar(elms[i])
	}
};
var generateScrollbar = function(elm) {
  "use strict";
	
	if (elm.scrollbarInit || (app.isMobile && elm.getAttribute(app.scrollBar.skipMobileAttr))) {
		return;
	}
	var dataHeight = (!elm.getAttribute(app.scrollBar.heightAttr)) ? elm.offsetHeight : elm.getAttribute(app.scrollBar.heightAttr);
	
	elm.style.height = dataHeight;
	elm.scrollbarInit = true;
	
	if(app.isMobile || !PerfectScrollbar) {
		elm.style.overflowX = 'scroll';
	} else {
		var dataWheelPropagation = (elm.getAttribute(app.scrollBar.wheelPropagationAttr)) ? elm.getAttribute(app.scrollBar.wheelPropagationAttr) : false;
		
		if (PerfectScrollbar) {
			if (elm.closest('.'+ app.sidebar.class )) {
				app.sidebar.scrollBarDom = new PerfectScrollbar(elm, {
					wheelPropagation: dataWheelPropagation
				});
			} else {
				new PerfectScrollbar(elm, {
					wheelPropagation: dataWheelPropagation
				});
			}
		}
	}
};


/* 03. Handle Sidebar Menu
------------------------------------------------ */
var handleSidebarMenuToggle = function(menus) {
	menus.map(function(menu) {
		menu.onclick = function(e) {
			e.preventDefault();
			
			var target = this.nextElementSibling;
			
			if (!document.querySelector('.'+ app.sidebar.minify.toggledClass)) {
				slideToggle(target);
				
				menus.map(function(m) {
					var otherTarget = m.nextElementSibling;
					if (otherTarget !== target) {
						slideUp(otherTarget);
						otherTarget.closest('.'+ app.sidebar.menuItemClass).classList.remove(app.sidebar.menuExpandClass);
					}
				});
				
				var targetElm = target.closest('.'+ app.sidebar.menuItemClass);
				if (targetElm.classList.contains(app.sidebar.menuExpandClass)) {
					targetElm.classList.remove(app.sidebar.menuExpandClass);
				} else {
					targetElm.classList.add(app.sidebar.menuExpandClass);
				}
			}
		}
	});
};
var handleSidebarMenu = function() {
	"use strict";
	
	var menus = [].slice.call(document.querySelectorAll('.'+ app.sidebar.class +' .'+ app.sidebar.menuClass +' > .'+ app.sidebar.menuItemClass +'.'+ app.sidebar.menuItemHasSubClass +' > .'+ app.sidebar.menuLinkClass +''));
	handleSidebarMenuToggle(menus);
	
	var menus = [].slice.call(document.querySelectorAll('.'+ app.sidebar.class +' .'+ app.sidebar.menuClass +' > .'+ app.sidebar.menuItemClass +'.'+ app.sidebar.menuItemHasSubClass +' .'+ app.sidebar.menuSubmenuClass +' .'+ app.sidebar.menuItemClass +'.'+ app.sidebar.menuItemHasSubClass +' > .'+ app.sidebar.menuLinkClass +''));
	handleSidebarMenuToggle(menus);
};


/* 04. Handle Sidebar Scroll Memory
------------------------------------------------ */
var handleSidebarScrollMemory = function() {
	if (!app.isMobile) {
		try {
			if (typeof(Storage) !== 'undefined' && typeof(localStorage) !== 'undefined') {
				var elm = document.querySelector('.'+ app.sidebar.class +' ['+ app.scrollBar.attr +']');
				
				if (elm) {
					elm.onscroll = function() {
						localStorage.setItem(app.sidebar.scrollBar.localStorage, this.scrollTop);
					}
					var defaultScroll = localStorage.getItem(app.sidebar.scrollBar.localStorage);
					if (defaultScroll) {
						document.querySelector('.'+ app.sidebar.class +' ['+ app.scrollBar.attr +']').scrollTop = defaultScroll;
					}
				}
			}
		} catch (error) {
			console.log(error);
		}
	}
};


/* 05. Handle Sidebar Minify
------------------------------------------------ */
var handleSidebarMinify = function() {
	var elms = [].slice.call(document.querySelectorAll('['+ app.sidebar.minify.toggleAttr +']'));
	elms.map(function(elm) {
		elm.onclick = function(e) {
			e.preventDefault();
		
			var targetElm = document.querySelector('.'+ app.class);
			
			if (targetElm) {
				if (targetElm.classList.contains(app.sidebar.minify.toggledClass)) {
					targetElm.classList.remove(app.sidebar.minify.toggledClass);
					localStorage.removeItem(app.sidebar.minify.localStorage);
				} else {
					targetElm.classList.add(app.sidebar.minify.toggledClass);
					localStorage.setItem(app.sidebar.minify.localStorage, true);
				}
			}
		};
	});
	
	if (typeof(Storage) !== 'undefined') {
		if (localStorage[app.sidebar.minify.localStorage]) {
			var targetElm = document.querySelector('.'+ app.class);
			
			if (targetElm) {
				targetElm.classList.add(app.sidebar.minify.toggledClass);
			}
		}
	}
};
var handleSidebarMobileToggle = function() {
	var elms = [].slice.call(document.querySelectorAll('['+ app.sidebar.mobile.toggleAttr +']'));
	
	elms.map(function(elm) {
		elm.onclick = function(e) {
			e.preventDefault();
			
			var targetElm = document.querySelector('.'+ app.class)
			
			if (targetElm) {
				targetElm.classList.remove(app.sidebar.mobile.closedClass);
				targetElm.classList.add(app.sidebar.mobile.toggledClass);
			}
		};
	});
};
var handleSidebarMobileDismiss = function() {
	var elms = [].slice.call(document.querySelectorAll('['+ app.sidebar.mobile.dismissAttr +']'));
	
	elms.map(function(elm) {
		elm.onclick = function(e) {
			e.preventDefault();
			
			var targetElm = document.querySelector('.'+ app.class)
			
			if (targetElm) {
				targetElm.classList.remove(app.sidebar.mobile.toggledClass);
				targetElm.classList.add(app.sidebar.mobile.closedClass);
				
				setTimeout(function() {
					targetElm.classList.remove(app.sidebar.mobile.closedClass);
				}, app.animation.speed);
			}
		};
	});
};


/* 06. Handle Sidebar Minify Float Menu
------------------------------------------------ */
var handleGetHiddenMenuHeight = function(elm) {
	elm.setAttribute('style', 'position: absolute; visibility: hidden; display: block !important');
	var targetHeight  = elm.clientHeight;
	elm.removeAttribute('style');
	return targetHeight;
}
var handleSidebarMinifyFloatMenuClick = function() {
	var elms = [].slice.call(document.querySelectorAll('.'+ app.floatSubmenu.class +' .'+ app.sidebar.menuItemClass +'.'+ app.sidebar.menuItemHasSubClass +' > .'+ app.sidebar.menuLinkClass));
	if (elms) {
		elms.map(function(elm) {
			elm.onclick = function(e) {
				e.preventDefault();
				var targetItem = this.closest('.' + app.sidebar.menuItemClass);
				var target = targetItem.querySelector('.' + app.sidebar.menuSubmenuClass);
				var targetStyle = getComputedStyle(target);
				var close = (targetStyle.getPropertyValue('display') != 'none') ? true : false;
				var expand = (targetStyle.getPropertyValue('display') != 'none') ? false : true;
				
				slideToggle(target);
				
				var loopHeight = setInterval(function() {
					var targetMenu = document.querySelector(app.floatSubmenu.id);
					var targetMenuArrow = document.querySelector(app.floatSubmenu.arrow.id);
					var targetMenuLine = document.querySelector(app.floatSubmenu.line.id);
					var targetHeight = targetMenu.clientHeight;
					var targetOffset = targetMenu.getBoundingClientRect();
					var targetOriTop = targetMenu.getAttribute('data-offset-top');
					var targetMenuTop = targetMenu.getAttribute('data-menu-offset-top');
					var targetTop 	 = targetOffset.top;
					var windowHeight = document.body.clientHeight;
					if (close) {
						if (targetTop > targetOriTop) {
							targetTop = (targetTop > targetOriTop) ? targetOriTop : targetTop;
							targetMenu.style.top = targetTop + 'px';
							targetMenu.style.bottom = 'auto';
							targetMenuArrow.style.top = '20px';
							targetMenuArrow.style.bottom = 'auto';
							targetMenuLine.style.top = '20px';
							targetMenuLine.style.bottom = 'auto';
						}
					}
					if (expand) {
						if ((windowHeight - targetTop) < targetHeight) {
							var arrowBottom = (windowHeight - targetMenuTop) - 22;
							targetMenu.style.top = 'auto';
							targetMenu.style.bottom = 0;
							targetMenuArrow.style.top = 'auto';
							targetMenuArrow.style.bottom = arrowBottom + 'px';
							targetMenuLine.style.top = '20px';
							targetMenuLine.style.bottom = arrowBottom + 'px';
						}
						var floatSubmenuElm = document.querySelector(app.floatSubmenu.id + ' .'+ app.floatSubmenu.class);
						if (targetHeight > windowHeight) {
							if (floatSubmenuElm) {
								var splitClass = (app.floatSubmenu.overflow.class).split(' ');
								for (var i = 0; i < splitClass.length; i++) {
									floatSubmenuElm.classList.add(splitClass[i]);
								}
							}
						}
					}
				}, 1);
				setTimeout(function() {
					clearInterval(loopHeight);
				}, app.animation.speed);
			}
		});
	}
}
var handleSidebarMinifyFloatMenu = function() {
	var elms = [].slice.call(document.querySelectorAll('.' + app.sidebar.class + ' .'+ app.sidebar.menuClass +' > .'+ app.sidebar.menuItemClass +'.'+ app.sidebar.menuItemHasSubClass +' > .'+ app.sidebar.menuLinkClass +''));
	if (elms) {
		elms.map(function(elm) {
			elm.onmouseenter = function() {
				var appElm = document.querySelector('.' + app.class);
				
				if (appElm && appElm.classList.contains(app.sidebar.minify.toggledClass)) {
					clearTimeout(app.floatSubmenu.timeout);
					
					var targetMenu = this.closest('.'+ app.sidebar.menuItemClass).querySelector('.' + app.sidebar.menuSubmenuClass);
					if (app.floatSubmenu.dom == this && document.querySelector(app.floatSubmenu.class)) {
						return;
					} else {
						app.floatSubmenu.dom = this;
					}
					var targetMenuHtml = targetMenu.innerHTML;
					if (targetMenuHtml) {
						var bodyStyle     = getComputedStyle(document.body);
						var sidebarOffset = document.querySelector('.'+ app.sidebar.class).getBoundingClientRect();
						var sidebarWidth  = parseInt(document.querySelector('.'+ app.sidebar.class).clientWidth);
						var sidebarX      = (bodyStyle.getPropertyValue('direction') != 'rtl') ? (sidebarOffset.left + sidebarWidth) : (document.body.clientWidth - sidebarOffset.left);
						var targetHeight  = handleGetHiddenMenuHeight(targetMenu);
						var targetOffset  = this.getBoundingClientRect();
						var targetTop     = targetOffset.top;
						var targetLeft    = (bodyStyle.getPropertyValue('direction') != 'rtl') ? sidebarX : 'auto';
						var targetRight   = (bodyStyle.getPropertyValue('direction') != 'rtl') ? 'auto' : sidebarX;
						var windowHeight  = document.body.clientHeight;
						
						if (!document.querySelector('#'+ app.floatSubmenu.id)) {
							var overflowClass = '';
							if (targetHeight > windowHeight) {
								overflowClass = app.floatSubmenu.overflow.class;
							}
							var html = document.createElement('div');
							html.setAttribute('id', app.floatSubmenu.id);
							html.setAttribute('class', app.floatSubmenu.class);
							html.setAttribute('data-offset-top', targetTop);
							html.setAttribute('data-menu-offset-top', targetTop);
							html.innerHTML = ''+
							'	<div class="'+ app.floatSubmenu.container.class +' '+ overflowClass +'">'+ targetMenuHtml + '</div>';
							appElm.appendChild(html);
							
							var elm = document.getElementById(app.floatSubmenu.id);
							elm.onmouseover = function() {
								clearTimeout(app.floatSubmenu.timeout);
							};
							elm.onmouseout = function() {
								app.floatSubmenu.timeout = setTimeout(() => {
									document.querySelector('#'+ app.floatSubmenu.id).remove();
								}, app.animation.speed);
							};
						} else {
							var floatSubmenu = document.querySelector('#'+ app.floatSubmenu.id);
							var floatSubmenuElm = document.querySelector('#'+ app.floatSubmenu.id + ' .'+ app.floatSubmenu.container.class);
							
							if (targetHeight > windowHeight) {
								if (floatSubmenuElm) {
									var splitClass = (app.floatSubmenu.overflow.class).split(' ');
									for (var i = 0; i < splitClass.length; i++) {
										floatSubmenuElm.classList.add(splitClass[i]);
									}
								}
							}
							floatSubmenu.setAttribute('data-offset-top', targetTop);
							floatSubmenu.setAttribute('data-menu-offset-top', targetTop);
							floatSubmenuElm.innerHTML = targetMenuHtml;
						}
				
						var targetHeight = document.querySelector('#'+ app.floatSubmenu.id).clientHeight;
						var floatSubmenuElm = document.querySelector('#'+ app.floatSubmenu.id);
						if ((windowHeight - targetTop) > targetHeight) {
							if (floatSubmenuElm) {
								floatSubmenuElm.style.top = targetTop + 'px';
								floatSubmenuElm.style.left = targetLeft + 'px';
								floatSubmenuElm.style.bottom = 'auto';
								floatSubmenuElm.style.right = targetRight + 'px';
							}
						} else {
							var arrowBottom = (windowHeight - targetTop) - 21;
							if (floatSubmenuElm) {
								floatSubmenuElm.style.top = 'auto';
								floatSubmenuElm.style.left = targetLeft + 'px';
								floatSubmenuElm.style.bottom = 0;
								floatSubmenuElm.style.right = targetRight + 'px';
							}
						}
						handleSidebarMinifyFloatMenuClick();
					} else {
						document.querySelector('#'+ app.floatSubmenu.id).remove();
						app.floatSubmenu.dom = '';
					}
				}
			}
			elm.onmouseleave = function() {
				var elm = document.querySelector('.' + app.class);
				if (elm && elm.classList.contains(app.sidebar.minify.toggledClass)) {
					app.floatSubmenu.timeout = setTimeout(() => {
						document.querySelector('#'+ app.floatSubmenu.id).remove();
						app.floatSubmenu.dom = '';
					}, 250);
				}
			}
		});
	}
};


/* 07. Handle Card - Expand
------------------------------------------------ */
var handleCardAction = function() {
	"use strict";

	if (app.card.expand.status) {
		return false;
	}
	app.card.expandStatus = true;

	// expand
	var expandTogglerList = [].slice.call(document.querySelectorAll('['+ app.card.expand.toggleAttr +']'));
	var expandTogglerTooltipList = expandTogglerList.map(function (expandTogglerEl) {
		expandTogglerEl.onclick = function(e) {
			e.preventDefault();
		
			var target = this.closest('.'+ app.card.class);
			var targetClass = app.card.expand.class;

			if (document.body.classList.contains(targetClass) && target.classList.contains(targetClass)) {
				target.removeAttribute('style');
				target.classList.remove(targetClass);
				document.body.classList.remove(targetClass);
			} else {
				document.body.classList.add(targetClass);
				target.classList.add(targetClass);
			}
		
			window.dispatchEvent(new Event('resize'));
		};
	
		return new bootstrap.Tooltip(expandTogglerEl, {
			title: app.card.expand.tooltipText,
			placement: 'bottom',
			trigger: 'hover',
			container: 'body'
		});
	});
};


/* 08. Handle Tooltip & Popover Activation
------------------------------------------------ */
var handelTooltipPopoverActivation = function() {
	"use strict";
	var tooltipTriggerList = [].slice.call(document.querySelectorAll('['+ app.tooltip.toggleAttr +']'))
	var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
		return new bootstrap.Tooltip(tooltipTriggerEl);
	});
	
	var popoverTriggerList = [].slice.call(document.querySelectorAll('['+ app.popover.toggleAttr +']'))
	var popoverList = popoverTriggerList.map(function (popoverTriggerEl) {
		return new bootstrap.Popover(popoverTriggerEl);
	});
};


/* 09. Handle Scroll to Top Button Activation
------------------------------------------------ */
var handleScrollToTopButton = function() {
	"use strict";
	var elmTriggerList = [].slice.call(document.querySelectorAll('['+ app.scrollTopButton.toggleAttr +']'));
	
	document.onscroll = function() {
		var doc = document.documentElement;
		var totalScroll = (window.pageYOffset || doc.scrollTop)  - (doc.clientTop || 0);
		var elmList = elmTriggerList.map(function(elm) {
			if (totalScroll >= 200) {
				if (!elm.classList.contains(app.scrollTopButton.showClass)) {
					elm.classList.add(app.scrollTopButton.showClass);
				}
			} else {
				elm.classList.remove(app.scrollTopButton.showClass);
			}
		});
	}
	
	var elmList = elmTriggerList.map(function(elm) {
		elm.onclick = function(e) {
			e.preventDefault();
			
			window.scrollTo({top: 0, behavior: 'smooth'});
		}
	});
};


/* 10. Handle Scroll to
------------------------------------------------ */
var handleScrollTo = function() {
	var elmTriggerList = [].slice.call(document.querySelectorAll('['+ app.scrollTo.toggleAttr +']'));
	var elmList = elmTriggerList.map(function(elm) {
		elm.onclick = function(e) {
			e.preventDefault();
		
			var targetAttr = (elm.getAttribute(app.scrollTo.targetAttr)) ? this.getAttribute(app.scrollTo.targetAttr) : this.getAttribute('href');
			var targetElm = document.querySelectorAll(targetAttr)[0];
			var targetHeader = document.querySelectorAll('.'+ app.header.class)[0];
			var targetHeight = targetHeader.offsetHeight;
			if (targetElm) {
				var targetTop = targetElm.offsetTop - targetHeight + 36;
				window.scrollTo({top: targetTop, behavior: 'smooth'});
			}
		}
	});
};


/* 11. Handle Theme Panel Expand
------------------------------------------------ */
var handleThemePanelExpand = function() {
	var elmList = [].slice.call(document.querySelectorAll('['+ app.themePanel.toggleAttr +']'));
	
	elmList.map(function(elm) {
		elm.onclick = function(e) {
			e.preventDefault();
			
			var targetContainer = document.querySelector('.'+ app.themePanel.class);
			var targetExpand = false;
		
			if (targetContainer.classList.contains(app.themePanel.activeClass)) {
				targetContainer.classList.remove(app.themePanel.activeClass);
				setCookie(app.themePanel.expandCookie, '');
			} else {
				targetContainer.classList.add(app.themePanel.activeClass);
				setCookie(app.themePanel.expandCookie, app.themePanel.expandCookieValue);
			}
		}
	});
	
	if (getCookie(app.themePanel.expandCookie) && getCookie(app.themePanel.expandCookie) == app.themePanel.expandCookieValue) {
		var elm = document.querySelector('['+ app.themePanel.toggleAttr +']');
		if (elm) {
			elm.click();
		}
	}
};


/* 12. Handle Theme Page Control
------------------------------------------------ */
var handleThemePageControl = function() {
	// Theme Click
	var elms = [].slice.call(document.querySelectorAll('.'+ app.themePanel.themeList.class +' ['+ app.themePanel.themeList.toggleAttr +']'));
	elms.map(function(elm) {
		elm.onclick = function() {
			var targetThemeClass = this.getAttribute(app.themePanel.themeList.toggleAttr);
			for (var x = 0; x < document.body.classList.length; x++) {
				var targetClass = document.body.classList[x];
				if (targetClass.search('theme-') > -1) {
					document.body.classList.remove(targetClass);
				}
			}
			if (targetThemeClass) {
				document.body.classList.add(targetThemeClass);
			}
		
			var togglers = [].slice.call(document.querySelectorAll('.'+ app.themePanel.themeList.class +' ['+ app.themePanel.themeList.toggleAttr +']'));
			togglers.map(function(toggler) {
				if (toggler != elm) {
					toggler.closest('li').classList.remove(app.themePanel.themeList.activeClass);
				} else {
					toggler.closest('li').classList.add(app.themePanel.themeList.activeClass);
				}
			});
			handleCssVariable();
			setCookie(app.themePanel.themeList.cookieName, targetThemeClass);
			document.dispatchEvent(new CustomEvent(app.themePanel.themeList.onChangeEvent));
		}
	});
	
	// Theme Cookie
	if (getCookie(app.themePanel.themeList.cookieName) && document.querySelector('.'+ app.themePanel.themeList.class)) {
		var targetElm = document.querySelector('.'+ app.themePanel.themeList.class +' ['+ app.themePanel.themeList.toggleAttr +'="'+ getCookie(app.themePanel.themeList.cookieName) +'"]');
		if (targetElm) {
			targetElm.click();
		}
	}
	
	// Dark Mode Click
	var elms = [].slice.call(document.querySelectorAll('.'+ app.themePanel.class +' [name="'+ app.themePanel.darkMode.inputName +'"]'));
	elms.map(function(elm) {
		elm.onchange = function() {
			var targetCookie = '';
	
			if (this.checked) {
				document.documentElement.setAttribute('data-bs-theme', 'dark');
				targetCookie = 'dark-mode';
			} else {
				document.documentElement.removeAttribute('data-bs-theme');
			}
			handleCssVariable();
			setCookie(app.themePanel.darkMode.cookieName, targetCookie);
			document.dispatchEvent(new CustomEvent(app.themePanel.themeList.onChangeEvent));
		}
	});
	
	// Dark Mode Cookie
	if (getCookie(app.themePanel.darkMode.cookieName) && document.querySelector('.'+ app.themePanel.class +' [name="'+ app.themePanel.darkMode.inputName +'"]')) {
		var elm = document.querySelector('.'+ app.themePanel.class +' [name="'+ app.themePanel.darkMode.inputName +'"]');
		if (elm) {
			elm.checked = true;
			elm.onchange();
		}
	}
};


/* 13. Handle CSS Variable
------------------------------------------------ */
var handleCssVariable = function() {
	var rootStyle = getComputedStyle(document.body);
	
	// font
	if (app.variableFontList && app.variablePrefix) {
		for (var i = 0; i < (app.variableFontList).length; i++) {
			app.font[app.variableFontList[i].replace(/-([a-z|0-9])/g, (match, letter) => letter.toUpperCase())] = rootStyle.getPropertyValue('--'+ app.variablePrefix + app.variableFontList[i]).trim();
		}
	}
	
	// color
	if (app.variableColorList && app.variablePrefix) {
		for (var i = 0; i < (app.variableColorList).length; i++) {
			app.color[app.variableColorList[i].replace(/-([a-z|0-9])/g, (match, letter) => letter.toUpperCase())] = rootStyle.getPropertyValue('--'+ app.variablePrefix + app.variableColorList[i]).trim();
		}
	}
};


/* 14. Handle Toggle Class
------------------------------------------------ */
var handleToggleClass = function() {
	var elmList = [].slice.call(document.querySelectorAll('['+ app.toggleClass.toggleAttr +']'));
	
	elmList.map(function(elm) {
		elm.onclick = function(e) {
			e.preventDefault();
			
			var targetToggleClass = this.getAttribute(app.toggleClass.toggleAttr);
			var targetDismissClass = this.getAttribute(app.dismissClass.toggleAttr);
			var targetToggleElm = document.querySelector(this.getAttribute(app.toggleClass.targetAttr));
		
			if (!targetDismissClass) {
				if (targetToggleElm.classList.contains(targetToggleClass)) {
					targetToggleElm.classList.remove(targetToggleClass);
				} else {
					targetToggleElm.classList.add(targetToggleClass);
				}
			} else {
				if (!targetToggleElm.classList.contains(targetToggleClass) && !targetToggleElm.classList.contains(targetDismissClass)) {
					if (targetToggleElm.classList.contains(targetToggleClass)) {
						targetToggleElm.classList.remove(targetToggleClass);
					} else {
						targetToggleElm.classList.add(targetToggleClass);
					}
				} else {
					if (targetToggleElm.classList.contains(targetToggleClass)) {
						targetToggleElm.classList.remove(targetToggleClass);
					} else {
						targetToggleElm.classList.add(targetToggleClass);
					}
					if (targetToggleElm.classList.contains(targetDismissClass)) {
						targetToggleElm.classList.remove(targetDismissClass);
					} else {
						targetToggleElm.classList.add(targetDismissClass);
					}
				}
			}
		}
	});
}


/* Application Controller
------------------------------------------------ */
var App = function () {
	"use strict";
	
	return {
		//main function
		init: function () {
			this.initComponent();
			this.initSidebar();
		},
		initSidebar: function() {
			handleSidebarScrollMemory();
			handleSidebarMinifyFloatMenu();
			handleSidebarMenu();
			handleSidebarMinify();
			handleSidebarMobileToggle();
			handleSidebarMobileDismiss();
		},
		initComponent: function() {
			handleScrollbar();
			handleCardAction();
			handelTooltipPopoverActivation();
			handleScrollToTopButton();
			handleScrollTo();
			handleThemePanelExpand();
			handleThemePageControl();
			handleCssVariable();
			handleToggleClass();
		},
		scrollTop: function() {
			window.scrollTo({top: 0, behavior: 'smooth'});
		}
	};
}();

document.addEventListener('DOMContentLoaded', function() {
	App.init();
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG5UZW1wbGF0ZSBOYW1lOiBTVFVESU8gLSBSZXNwb25zaXZlIEJvb3RzdHJhcCA1IEFkbWluIFRlbXBsYXRlXG5WZXJzaW9uOiA0LjAuMFxuQXV0aG9yOiBTZWFuIE5ndVxuXHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0QVBQUyBDT05URU5UIFRBQkxFXG5cdC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuXHQ8IS0tID09PT09PT09IEdMT0JBTCBTQ1JJUFQgU0VUVElORyA9PT09PT09PSAtLT5cbiAgMDEuIEdsb2JhbCBWYXJpYWJsZVxuICAwMi4gSGFuZGxlIFNjcm9sbGJhclxuICAwMy4gSGFuZGxlIFNpZGViYXIgTWVudVxuICAwNC4gSGFuZGxlIFNpZGViYXIgTWluaWZ5XG4gIDA1LiBIYW5kbGUgU2lkZWJhciBNaW5pZnkgRmxvYXQgTWVudVxuICAwNi4gSGFuZGxlIERyb3Bkb3duIENsb3NlIE9wdGlvblxuICAwNy4gSGFuZGxlIENhcmQgLSBSZW1vdmUgLyBSZWxvYWQgLyBDb2xsYXBzZSAvIEV4cGFuZFxuICAwOC4gSGFuZGxlIFRvb2x0aXAgJiBQb3BvdmVyIEFjdGl2YXRpb25cbiAgMDkuIEhhbmRsZSBTY3JvbGwgdG8gVG9wIEJ1dHRvbiBBY3RpdmF0aW9uXG4gIDEwLiBIYW5kbGUgaGV4VG9SZ2JhXG4gIDExLiBIYW5kbGUgU2Nyb2xsIHRvXG4gIDEyLiBIYW5kbGUgVGhlbWUgUGFuZWwgRXhwYW5kXG4gIDEzLiBIYW5kbGUgVGhlbWUgUGFnZSBDb250cm9sXG4gIDE0LiBIYW5kbGUgRW5hYmxlIFRvb2x0aXAgJiBQb3BvdmVyXG5cdFxuXHQ8IS0tID09PT09PT09IEFQUExJQ0FUSU9OIFNFVFRJTkcgPT09PT09PT0gLS0+XG5cdEFwcGxpY2F0aW9uIENvbnRyb2xsZXJcbiovXG5cblxuXG4vKiAwMS4gR2xvYmFsIFZhcmlhYmxlXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbnZhciBhcHAgPSB7XG5cdGNsYXNzOiAnYXBwJyxcblx0aXNNb2JpbGU6ICgoL0FuZHJvaWR8d2ViT1N8aVBob25lfGlQYWR8aVBvZHxCbGFja0JlcnJ5fElFTW9iaWxlfE9wZXJhIE1pbmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpKSB8fCB3aW5kb3cuaW5uZXJXaWR0aCA8IDk5MiksXG5cdGhlYWRlcjoge1xuXHRcdGNsYXNzOiAnYXBwLWhlYWRlcidcblx0fSxcblx0c2lkZWJhcjoge1xuXHRcdGNsYXNzOiAnYXBwLXNpZGViYXInLFxuXHRcdG1lbnVDbGFzczogJ21lbnUnLFxuXHRcdG1lbnVJdGVtQ2xhc3M6ICdtZW51LWl0ZW0nLFxuXHRcdG1lbnVJdGVtSGFzU3ViQ2xhc3M6ICdoYXMtc3ViJyxcblx0XHRtZW51TGlua0NsYXNzOiAnbWVudS1saW5rJyxcblx0XHRtZW51U3VibWVudUNsYXNzOiAnbWVudS1zdWJtZW51Jyxcblx0XHRtZW51RXhwYW5kQ2xhc3M6ICdleHBhbmQnLFxuXHRcdG1pbmlmeToge1xuXHRcdFx0dG9nZ2xlZENsYXNzOiAnYXBwLXNpZGViYXItbWluaWZpZWQnLFxuXHRcdFx0bG9jYWxTdG9yYWdlOiAnYXBwU2lkZWJhck1pbmlmaWVkJyxcblx0XHRcdHRvZ2dsZUF0dHI6ICdkYXRhLXRvZ2dsZT1cInNpZGViYXItbWluaWZ5XCInXG5cdFx0fSxcblx0XHRtb2JpbGU6IHtcblx0XHRcdHRvZ2dsZWRDbGFzczogJ2FwcC1zaWRlYmFyLW1vYmlsZS10b2dnbGVkJyxcblx0XHRcdGNsb3NlZENsYXNzOiAnYXBwLXNpZGViYXItbW9iaWxlLWNsb3NlZCcsXG5cdFx0XHRkaXNtaXNzQXR0cjogJ2RhdGEtZGlzbWlzcz1cInNpZGViYXItbW9iaWxlXCInLFxuXHRcdFx0dG9nZ2xlQXR0cjogJ2RhdGEtdG9nZ2xlPVwic2lkZWJhci1tb2JpbGVcIicsXG5cdFx0fSxcblx0XHRzY3JvbGxCYXI6IHtcblx0XHRcdGxvY2FsU3RvcmFnZTogJ2FwcFNpZGViYXJTY3JvbGxQb3NpdGlvbicsXG5cdFx0XHRkb206ICcnLFxuXHRcdH1cblx0fSxcblx0ZmxvYXRTdWJtZW51OiB7XG5cdFx0aWQ6ICdhcHAtZmxvYXQtc3VibWVudScsXG5cdFx0ZG9tOiAnJyxcblx0XHR0aW1lb3V0OiAnJyxcblx0XHRjbGFzczogJ2FwcC1mbG9hdC1zdWJtZW51Jyxcblx0XHRjb250YWluZXI6IHtcblx0XHRcdGNsYXNzOiAnYXBwLWZsb2F0LXN1Ym1lbnUtY29udGFpbmVyJ1xuXHRcdH0sXG5cdFx0b3ZlcmZsb3c6IHtcblx0XHRcdGNsYXNzOiAnb3ZlcmZsb3ctc2Nyb2xsIG1oLTEwMHZoJ1xuXHRcdH1cblx0fSxcblx0dGhlbWVQYW5lbDoge1xuXHRcdGNsYXNzOiAndGhlbWUtcGFuZWwnLFxuXHRcdHRvZ2dsZUF0dHI6ICdkYXRhLWNsaWNrPVwidGhlbWUtcGFuZWwtZXhwYW5kXCInLFxuXHRcdGV4cGFuZENvb2tpZTogJ3RoZW1lLXBhbmVsJyxcblx0XHRleHBhbmRDb29raWVWYWx1ZTogJ2V4cGFuZCcsXG5cdFx0YWN0aXZlQ2xhc3M6ICdhY3RpdmUnLFxuXHRcdHRoZW1lTGlzdDoge1xuXHRcdFx0Y2xhc3M6ICd0aGVtZS1saXN0Jyxcblx0XHRcdHRvZ2dsZUF0dHI6ICdkYXRhLXRoZW1lJyxcblx0XHRcdGFjdGl2ZUNsYXNzOiAnYWN0aXZlJyxcblx0XHRcdGNvb2tpZU5hbWU6ICd0aGVtZScsXG5cdFx0XHRvbkNoYW5nZUV2ZW50OiAndGhlbWUtcmVsb2FkJ1xuXHRcdH0sXG5cdFx0ZGFya01vZGU6IHtcblx0XHRcdGNsYXNzOiAnZGFyay1tb2RlJyxcblx0XHRcdGlucHV0TmFtZTogJ2FwcC10aGVtZS1kYXJrLW1vZGUnLFxuXHRcdFx0Y29va2llTmFtZTogJ2RhcmstbW9kZSdcblx0XHR9XG5cdH0sXG5cdGFuaW1hdGlvbjogeyBcblx0XHRzcGVlZDogMzAwIFxuXHR9LFxuXHRzY3JvbGxCYXI6IHtcblx0XHRhdHRyOiAnZGF0YS1zY3JvbGxiYXI9XCJ0cnVlXCInLFxuXHRcdGhlaWdodEF0dHI6ICdkYXRhLWhlaWdodCcsXG5cdFx0c2tpcE1vYmlsZUF0dHI6ICdkYXRhLXNraXAtbW9iaWxlPVwidHJ1ZVwiJyxcblx0XHR3aGVlbFByb3BhZ2F0aW9uQXR0cjogJ2RhdGEtd2hlZWwtcHJvcGFnYXRpb24nXG5cdH0sXG5cdHNjcm9sbFRvOiB7XG5cdFx0dG9nZ2xlQXR0cjogJ2RhdGEtdG9nZ2xlPVwic2Nyb2xsLXRvXCInLFxuXHRcdHRhcmdldEF0dHI6ICdkYXRhLXRhcmdldCdcblx0fSxcblx0c2Nyb2xsVG9wQnV0dG9uOiB7XG5cdFx0dG9nZ2xlQXR0cjogJ2RhdGEtY2xpY2s9XCJzY3JvbGwtdG9wXCInLFxuXHRcdHNob3dDbGFzczogJ3Nob3cnXG5cdH0sXG5cdGNhcmQ6IHsgXG5cdFx0Y2xhc3M6ICdjYXJkJyxcblx0XHRleHBhbmQ6IHtcblx0XHRcdHRvZ2dsZUF0dHI6ICdkYXRhLXRvZ2dsZT1cImNhcmQtZXhwYW5kXCInLFxuXHRcdFx0c3RhdHVzOiBmYWxzZSxcblx0XHRcdGNsYXNzOiAnY2FyZC1leHBhbmQnLFxuXHRcdFx0dG9vbHRpcFRleHQ6ICdFeHBhbmQgLyBDb21wcmVzcydcblx0XHR9XG5cdH0sXG5cdHRvb2x0aXA6IHtcblx0XHR0b2dnbGVBdHRyOiAnZGF0YS1icy10b2dnbGU9XCJ0b29sdGlwXCInXG5cdH0sXG5cdHBvcG92ZXI6IHtcblx0XHR0b2dnbGVBdHRyOiAnZGF0YS1icy10b2dnbGU9XCJwb3BvdmVyXCInXG5cdH0sXG5cdGRpc21pc3NDbGFzczoge1xuXHRcdHRvZ2dsZUF0dHI6ICdkYXRhLWRpc21pc3MtY2xhc3MnLFxuXHRcdHRhcmdldEF0dHI6ICdkYXRhLWRpc21pc3MtdGFyZ2V0J1xuXHR9LFxuXHR0b2dnbGVDbGFzczoge1xuXHRcdHRvZ2dsZUF0dHI6ICdkYXRhLXRvZ2dsZS1jbGFzcycsXG5cdFx0dGFyZ2V0QXR0cjogJ2RhdGEtdG9nZ2xlLXRhcmdldCdcblx0fSxcblx0Zm9udDogeyB9LFxuXHRjb2xvcjogeyB9LFxuXHR2YXJpYWJsZVByZWZpeDogJ2JzLScsXG5cdHZhcmlhYmxlRm9udExpc3Q6IFsnYm9keS1mb250LWZhbWlseScsICdib2R5LWZvbnQtc2l6ZScsICdib2R5LWZvbnQtd2VpZ2h0JywgJ2JvZHktbGluZS1oZWlnaHQnXSxcblx0dmFyaWFibGVDb2xvckxpc3Q6IFtcblx0XHQndGhlbWUnLCAndGhlbWUtcmdiJywgJ3RoZW1lLWNvbG9yJywgJ3RoZW1lLWNvbG9yLXJnYicsXG5cdFx0J2RlZmF1bHQnLCAnZGVmYXVsdC1yZ2InLFxuXHRcdCdwcmltYXJ5JywgJ3ByaW1hcnktcmdiJywgJ3ByaW1hcnktYmctc3VidGxlJywgJ3ByaW1hcnktdGV4dCcsICdwcmltYXJ5LWJvcmRlci1zdWJ0bGUnLFxuXHRcdCdzZWNvbmRhcnknLCAnc2Vjb25kYXJ5LXJnYicsICdzZWNvbmRhcnktYmctc3VidGxlJywgJ3NlY29uZGFyeS10ZXh0JywgJ3NlY29uZGFyeS1ib3JkZXItc3VidGxlJyxcblx0XHQnc3VjY2VzcycsICdzdWNjZXNzLXJnYicsICdzdWNjZXNzLWJnLXN1YnRsZScsICdzdWNjZXNzLXRleHQnLCAnc3VjY2Vzcy1ib3JkZXItc3VidGxlJyxcblx0XHQnd2FybmluZycsICd3YXJuaW5nLXJnYicsICd3YXJuaW5nLWJnLXN1YnRsZScsICd3YXJuaW5nLXRleHQnLCAnd2FybmluZy1ib3JkZXItc3VidGxlJyxcblx0XHQnaW5mbycsICdpbmZvLXJnYicsICdpbmZvLWJnLXN1YnRsZScsICdpbmZvLXRleHQnLCAnaW5mby1ib3JkZXItc3VidGxlJyxcblx0XHQnZGFuZ2VyJywgJ2Rhbmdlci1yZ2InLCAnZGFuZ2VyLWJnLXN1YnRsZScsICdkYW5nZXItdGV4dCcsICdkYW5nZXItYm9yZGVyLXN1YnRsZScsXG5cdFx0J2xpZ2h0JywgJ2xpZ2h0LXJnYicsICdsaWdodC1iZy1zdWJ0bGUnLCAnbGlnaHQtdGV4dCcsICdsaWdodC1ib3JkZXItc3VidGxlJyxcblx0XHQnZGFyaycsICdkYXJrLXJnYicsICdkYXJrLWJnLXN1YnRsZScsICdkYXJrLXRleHQnLCAnZGFyay1ib3JkZXItc3VidGxlJyxcblx0XHQnd2hpdGUnLCAnd2hpdGUtcmdiJyxcblx0XHQnYmxhY2snLCAnYmxhY2stcmdiJyxcblx0XHQndGVhbCcsICd0ZWFsLXJnYicsXG5cdFx0J2luZGlnbycsICdpbmRpZ28tcmdiJywgXG5cdFx0J3B1cnBsZScsICdwdXJwbGUtcmdiJyxcblx0XHQneWVsbG93JywgJ3llbGxvdy1yZ2InLFxuXHRcdCdwaW5rJywgJ3BpbmstcmdiJyxcblx0XHQnY3lhbicsICdjeWFuLXJnYicsXG5cdFx0J2dyYXktMTAwJywgJ2dyYXktMjAwJywgJ2dyYXktMzAwJywgJ2dyYXktNDAwJywgJ2dyYXktNTAwJywgICdncmF5LTYwMCcsICdncmF5LTcwMCcsICdncmF5LTgwMCcsICdncmF5LTkwMCcsIFxuXHRcdCdncmF5LTEwMC1yZ2InLCAnZ3JheS0yMDAtcmdiJywgJ2dyYXktMzAwLXJnYicsICdncmF5LTQwMC1yZ2InLCAnZ3JheS01MDAtcmdiJywgICdncmF5LTYwMC1yZ2InLCAnZ3JheS03MDAtcmdiJywgJ2dyYXktODAwLXJnYicsICdncmF5LTkwMC1yZ2InLCBcblx0XHQnbXV0ZWQnLCAnbXV0ZWQtcmdiJywgJ2VtcGhhc2lzLWNvbG9yJywgJ2VtcGhhc2lzLWNvbG9yLXJnYicsXG5cdFx0J2NvbXBvbmVudC1iZycsICdjb21wb25lbnQtYmctcmdiJywgJ2NvbXBvbmVudC1jb2xvcicsICdjb21wb25lbnQtY29sb3ItcmdiJyxcblx0XHQnYm9keS1iZycsICdib2R5LWJnLXJnYicsICdib2R5LWNvbG9yJywgJ2JvZHktY29sb3ItcmdiJyxcblx0XHQnaGVhZGluZy1jb2xvcicsIFxuXHRcdCdzZWNvbmRhcnktY29sb3InLCAnc2Vjb25kYXJ5LWNvbG9yLXJnYicsICdzZWNvbmRhcnktYmcnLCAnc2Vjb25kYXJ5LWJnLXJnYicsXG5cdFx0J3RlcnRpYXJ5LWNvbG9yJywgJ3RlcnRpYXJ5LWNvbG9yLXJnYicsICd0ZXJ0aWFyeS1iZycsICd0ZXJ0aWFyeS1iZy1yZ2InLFxuXHRcdCdsaW5rLWNvbG9yJywgJ2xpbmstY29sb3ItcmdiJywgJ2xpbmstaG92ZXItY29sb3InLCAnbGluay1ob3Zlci1jb2xvci1yZ2InLCBcblx0XHQnYm9yZGVyLWNvbG9yJywgJ2JvcmRlci1jb2xvci10cmFuc2x1Y2VudCdcblx0XSxcbn1cblxudmFyIHNsaWRlVXAgPSBmdW5jdGlvbihlbG0sIGR1cmF0aW9uID0gYXBwLmFuaW1hdGlvbi5zcGVlZCkge1xuXHRpZiAoIWVsbS5jbGFzc0xpc3QuY29udGFpbnMoJ3RyYW5zaXRpb25pbmcnKSkge1xuXHRcdGVsbS5jbGFzc0xpc3QuYWRkKCd0cmFuc2l0aW9uaW5nJyk7XG5cdFx0ZWxtLnN0eWxlLnRyYW5zaXRpb25Qcm9wZXJ0eSA9ICdoZWlnaHQsIG1hcmdpbiwgcGFkZGluZyc7XG5cdFx0ZWxtLnN0eWxlLnRyYW5zaXRpb25EdXJhdGlvbiA9IGR1cmF0aW9uICsgJ21zJztcblx0XHRlbG0uc3R5bGUuYm94U2l6aW5nID0gJ2JvcmRlci1ib3gnO1xuXHRcdGVsbS5zdHlsZS5oZWlnaHQgPSBlbG0ub2Zmc2V0SGVpZ2h0ICsgJ3B4Jztcblx0XHRlbG0ub2Zmc2V0SGVpZ2h0O1xuXHRcdGVsbS5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nO1xuXHRcdGVsbS5zdHlsZS5oZWlnaHQgPSAwO1xuXHRcdGVsbS5zdHlsZS5wYWRkaW5nVG9wID0gMDtcblx0XHRlbG0uc3R5bGUucGFkZGluZ0JvdHRvbSA9IDA7XG5cdFx0ZWxtLnN0eWxlLm1hcmdpblRvcCA9IDA7XG5cdFx0ZWxtLnN0eWxlLm1hcmdpbkJvdHRvbSA9IDA7XG5cdFx0d2luZG93LnNldFRpbWVvdXQoICgpID0+IHtcblx0XHRcdGVsbS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0ZWxtLnN0eWxlLnJlbW92ZVByb3BlcnR5KCdoZWlnaHQnKTtcblx0XHRcdGVsbS5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgncGFkZGluZy10b3AnKTtcblx0XHRcdGVsbS5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgncGFkZGluZy1ib3R0b20nKTtcblx0XHRcdGVsbS5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgnbWFyZ2luLXRvcCcpO1xuXHRcdFx0ZWxtLnN0eWxlLnJlbW92ZVByb3BlcnR5KCdtYXJnaW4tYm90dG9tJyk7XG5cdFx0XHRlbG0uc3R5bGUucmVtb3ZlUHJvcGVydHkoJ292ZXJmbG93Jyk7XG5cdFx0XHRlbG0uc3R5bGUucmVtb3ZlUHJvcGVydHkoJ3RyYW5zaXRpb24tZHVyYXRpb24nKTtcblx0XHRcdGVsbS5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgndHJhbnNpdGlvbi1wcm9wZXJ0eScpO1xuXHRcdFx0ZWxtLmNsYXNzTGlzdC5yZW1vdmUoJ3RyYW5zaXRpb25pbmcnKTtcblx0XHR9LCBkdXJhdGlvbik7XG5cdH1cbn07XG5cbnZhciBzbGlkZURvd24gPSBmdW5jdGlvbihlbG0sIGR1cmF0aW9uID0gYXBwLmFuaW1hdGlvbi5zcGVlZCkge1xuXHRpZiAoIWVsbS5jbGFzc0xpc3QuY29udGFpbnMoJ3RyYW5zaXRpb25pbmcnKSkge1xuXHRcdGVsbS5jbGFzc0xpc3QuYWRkKCd0cmFuc2l0aW9uaW5nJyk7XG5cdFx0ZWxtLnN0eWxlLnJlbW92ZVByb3BlcnR5KCdkaXNwbGF5Jyk7XG5cdFx0bGV0IGRpc3BsYXkgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbG0pLmRpc3BsYXk7XG5cdFx0aWYgKGRpc3BsYXkgPT09ICdub25lJykgZGlzcGxheSA9ICdibG9jayc7XG5cdFx0ZWxtLnN0eWxlLmRpc3BsYXkgPSBkaXNwbGF5O1xuXHRcdGxldCBoZWlnaHQgPSBlbG0ub2Zmc2V0SGVpZ2h0O1xuXHRcdGVsbS5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nO1xuXHRcdGVsbS5zdHlsZS5oZWlnaHQgPSAwO1xuXHRcdGVsbS5zdHlsZS5wYWRkaW5nVG9wID0gMDtcblx0XHRlbG0uc3R5bGUucGFkZGluZ0JvdHRvbSA9IDA7XG5cdFx0ZWxtLnN0eWxlLm1hcmdpblRvcCA9IDA7XG5cdFx0ZWxtLnN0eWxlLm1hcmdpbkJvdHRvbSA9IDA7XG5cdFx0ZWxtLm9mZnNldEhlaWdodDtcblx0XHRlbG0uc3R5bGUuYm94U2l6aW5nID0gJ2JvcmRlci1ib3gnO1xuXHRcdGVsbS5zdHlsZS50cmFuc2l0aW9uUHJvcGVydHkgPSBcImhlaWdodCwgbWFyZ2luLCBwYWRkaW5nXCI7XG5cdFx0ZWxtLnN0eWxlLnRyYW5zaXRpb25EdXJhdGlvbiA9IGR1cmF0aW9uICsgJ21zJztcblx0XHRlbG0uc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0ICsgJ3B4Jztcblx0XHRlbG0uc3R5bGUucmVtb3ZlUHJvcGVydHkoJ3BhZGRpbmctdG9wJyk7XG5cdFx0ZWxtLnN0eWxlLnJlbW92ZVByb3BlcnR5KCdwYWRkaW5nLWJvdHRvbScpO1xuXHRcdGVsbS5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgnbWFyZ2luLXRvcCcpO1xuXHRcdGVsbS5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgnbWFyZ2luLWJvdHRvbScpO1xuXHRcdHdpbmRvdy5zZXRUaW1lb3V0KCAoKSA9PiB7XG5cdFx0XHRlbG0uc3R5bGUucmVtb3ZlUHJvcGVydHkoJ2hlaWdodCcpO1xuXHRcdFx0ZWxtLnN0eWxlLnJlbW92ZVByb3BlcnR5KCdvdmVyZmxvdycpO1xuXHRcdFx0ZWxtLnN0eWxlLnJlbW92ZVByb3BlcnR5KCd0cmFuc2l0aW9uLWR1cmF0aW9uJyk7XG5cdFx0XHRlbG0uc3R5bGUucmVtb3ZlUHJvcGVydHkoJ3RyYW5zaXRpb24tcHJvcGVydHknKTtcblx0XHRcdGVsbS5jbGFzc0xpc3QucmVtb3ZlKCd0cmFuc2l0aW9uaW5nJyk7XG5cdFx0fSwgZHVyYXRpb24pO1xuXHR9XG59O1xuXG52YXIgc2xpZGVUb2dnbGUgPSBmdW5jdGlvbihlbG0sIGR1cmF0aW9uID0gYXBwLmFuaW1hdGlvbi5zcGVlZCkge1xuXHRpZiAod2luZG93LmdldENvbXB1dGVkU3R5bGUoZWxtKS5kaXNwbGF5ID09PSAnbm9uZScpIHtcblx0XHRyZXR1cm4gc2xpZGVEb3duKGVsbSwgZHVyYXRpb24pO1xuXHR9IGVsc2Uge1xuXHRcdHJldHVybiBzbGlkZVVwKGVsbSwgZHVyYXRpb24pO1xuXHR9XG59O1xuXG52YXIgc2V0Q29va2llID0gZnVuY3Rpb24oY29va2llTmFtZSwgY29va2llVmFsdWUpIHtcblx0dmFyIG5vdyA9IG5ldyBEYXRlKCk7XG4gIHZhciB0aW1lID0gbm93LmdldFRpbWUoKTtcbiAgdmFyIGV4cGlyZVRpbWUgPSB0aW1lICsgMTAwMCozNjAwMDtcbiAgbm93LnNldFRpbWUoZXhwaXJlVGltZSk7XG4gIGRvY3VtZW50LmNvb2tpZSA9IGNvb2tpZU5hbWUgKyAnPScrIGNvb2tpZVZhbHVlICsnO2V4cGlyZXM9Jytub3cudG9VVENTdHJpbmcoKSsnO3BhdGg9Lyc7XG59O1xuXG52YXIgZ2V0Q29va2llID0gZnVuY3Rpb24oY29va2llTmFtZSkge1xuICBsZXQgbmFtZSA9IGNvb2tpZU5hbWUgKyBcIj1cIjtcbiAgbGV0IGRlY29kZWRDb29raWUgPSBkZWNvZGVVUklDb21wb25lbnQoZG9jdW1lbnQuY29va2llKTtcbiAgbGV0IGNhID0gZGVjb2RlZENvb2tpZS5zcGxpdCgnOycpO1xuICBmb3IobGV0IGkgPSAwOyBpIDxjYS5sZW5ndGg7IGkrKykge1xuICAgIGxldCBjID0gY2FbaV07XG4gICAgd2hpbGUgKGMuY2hhckF0KDApID09ICcgJykge1xuICAgICAgYyA9IGMuc3Vic3RyaW5nKDEpO1xuICAgIH1cbiAgICBpZiAoYy5pbmRleE9mKG5hbWUpID09IDApIHtcbiAgICAgIHJldHVybiBjLnN1YnN0cmluZyhuYW1lLmxlbmd0aCwgYy5sZW5ndGgpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gXCJcIjtcbn07XG5cblxuLyogMDIuIEhhbmRsZSBTY3JvbGxiYXJcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xudmFyIGhhbmRsZVNjcm9sbGJhciA9IGZ1bmN0aW9uKCkge1xuXHRcInVzZSBzdHJpY3RcIjtcblx0XG5cdHZhciBlbG1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnWycrIGFwcC5zY3JvbGxCYXIuYXR0ciArJ10nKTtcblx0XHRcblx0Zm9yICh2YXIgaSA9IDA7IGkgPCBlbG1zLmxlbmd0aDsgaSsrKSB7XG5cdFx0Z2VuZXJhdGVTY3JvbGxiYXIoZWxtc1tpXSlcblx0fVxufTtcbnZhciBnZW5lcmF0ZVNjcm9sbGJhciA9IGZ1bmN0aW9uKGVsbSkge1xuICBcInVzZSBzdHJpY3RcIjtcblx0XG5cdGlmIChlbG0uc2Nyb2xsYmFySW5pdCB8fCAoYXBwLmlzTW9iaWxlICYmIGVsbS5nZXRBdHRyaWJ1dGUoYXBwLnNjcm9sbEJhci5za2lwTW9iaWxlQXR0cikpKSB7XG5cdFx0cmV0dXJuO1xuXHR9XG5cdHZhciBkYXRhSGVpZ2h0ID0gKCFlbG0uZ2V0QXR0cmlidXRlKGFwcC5zY3JvbGxCYXIuaGVpZ2h0QXR0cikpID8gZWxtLm9mZnNldEhlaWdodCA6IGVsbS5nZXRBdHRyaWJ1dGUoYXBwLnNjcm9sbEJhci5oZWlnaHRBdHRyKTtcblx0XG5cdGVsbS5zdHlsZS5oZWlnaHQgPSBkYXRhSGVpZ2h0O1xuXHRlbG0uc2Nyb2xsYmFySW5pdCA9IHRydWU7XG5cdFxuXHRpZihhcHAuaXNNb2JpbGUgfHwgIVBlcmZlY3RTY3JvbGxiYXIpIHtcblx0XHRlbG0uc3R5bGUub3ZlcmZsb3dYID0gJ3Njcm9sbCc7XG5cdH0gZWxzZSB7XG5cdFx0dmFyIGRhdGFXaGVlbFByb3BhZ2F0aW9uID0gKGVsbS5nZXRBdHRyaWJ1dGUoYXBwLnNjcm9sbEJhci53aGVlbFByb3BhZ2F0aW9uQXR0cikpID8gZWxtLmdldEF0dHJpYnV0ZShhcHAuc2Nyb2xsQmFyLndoZWVsUHJvcGFnYXRpb25BdHRyKSA6IGZhbHNlO1xuXHRcdFxuXHRcdGlmIChQZXJmZWN0U2Nyb2xsYmFyKSB7XG5cdFx0XHRpZiAoZWxtLmNsb3Nlc3QoJy4nKyBhcHAuc2lkZWJhci5jbGFzcyApKSB7XG5cdFx0XHRcdGFwcC5zaWRlYmFyLnNjcm9sbEJhckRvbSA9IG5ldyBQZXJmZWN0U2Nyb2xsYmFyKGVsbSwge1xuXHRcdFx0XHRcdHdoZWVsUHJvcGFnYXRpb246IGRhdGFXaGVlbFByb3BhZ2F0aW9uXG5cdFx0XHRcdH0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0bmV3IFBlcmZlY3RTY3JvbGxiYXIoZWxtLCB7XG5cdFx0XHRcdFx0d2hlZWxQcm9wYWdhdGlvbjogZGF0YVdoZWVsUHJvcGFnYXRpb25cblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG59O1xuXG5cbi8qIDAzLiBIYW5kbGUgU2lkZWJhciBNZW51XG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbnZhciBoYW5kbGVTaWRlYmFyTWVudVRvZ2dsZSA9IGZ1bmN0aW9uKG1lbnVzKSB7XG5cdG1lbnVzLm1hcChmdW5jdGlvbihtZW51KSB7XG5cdFx0bWVudS5vbmNsaWNrID0gZnVuY3Rpb24oZSkge1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XG5cdFx0XHR2YXIgdGFyZ2V0ID0gdGhpcy5uZXh0RWxlbWVudFNpYmxpbmc7XG5cdFx0XHRcblx0XHRcdGlmICghZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLicrIGFwcC5zaWRlYmFyLm1pbmlmeS50b2dnbGVkQ2xhc3MpKSB7XG5cdFx0XHRcdHNsaWRlVG9nZ2xlKHRhcmdldCk7XG5cdFx0XHRcdFxuXHRcdFx0XHRtZW51cy5tYXAoZnVuY3Rpb24obSkge1xuXHRcdFx0XHRcdHZhciBvdGhlclRhcmdldCA9IG0ubmV4dEVsZW1lbnRTaWJsaW5nO1xuXHRcdFx0XHRcdGlmIChvdGhlclRhcmdldCAhPT0gdGFyZ2V0KSB7XG5cdFx0XHRcdFx0XHRzbGlkZVVwKG90aGVyVGFyZ2V0KTtcblx0XHRcdFx0XHRcdG90aGVyVGFyZ2V0LmNsb3Nlc3QoJy4nKyBhcHAuc2lkZWJhci5tZW51SXRlbUNsYXNzKS5jbGFzc0xpc3QucmVtb3ZlKGFwcC5zaWRlYmFyLm1lbnVFeHBhbmRDbGFzcyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdFx0XG5cdFx0XHRcdHZhciB0YXJnZXRFbG0gPSB0YXJnZXQuY2xvc2VzdCgnLicrIGFwcC5zaWRlYmFyLm1lbnVJdGVtQ2xhc3MpO1xuXHRcdFx0XHRpZiAodGFyZ2V0RWxtLmNsYXNzTGlzdC5jb250YWlucyhhcHAuc2lkZWJhci5tZW51RXhwYW5kQ2xhc3MpKSB7XG5cdFx0XHRcdFx0dGFyZ2V0RWxtLmNsYXNzTGlzdC5yZW1vdmUoYXBwLnNpZGViYXIubWVudUV4cGFuZENsYXNzKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR0YXJnZXRFbG0uY2xhc3NMaXN0LmFkZChhcHAuc2lkZWJhci5tZW51RXhwYW5kQ2xhc3MpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9KTtcbn07XG52YXIgaGFuZGxlU2lkZWJhck1lbnUgPSBmdW5jdGlvbigpIHtcblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdFxuXHR2YXIgbWVudXMgPSBbXS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy4nKyBhcHAuc2lkZWJhci5jbGFzcyArJyAuJysgYXBwLnNpZGViYXIubWVudUNsYXNzICsnID4gLicrIGFwcC5zaWRlYmFyLm1lbnVJdGVtQ2xhc3MgKycuJysgYXBwLnNpZGViYXIubWVudUl0ZW1IYXNTdWJDbGFzcyArJyA+IC4nKyBhcHAuc2lkZWJhci5tZW51TGlua0NsYXNzICsnJykpO1xuXHRoYW5kbGVTaWRlYmFyTWVudVRvZ2dsZShtZW51cyk7XG5cdFxuXHR2YXIgbWVudXMgPSBbXS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy4nKyBhcHAuc2lkZWJhci5jbGFzcyArJyAuJysgYXBwLnNpZGViYXIubWVudUNsYXNzICsnID4gLicrIGFwcC5zaWRlYmFyLm1lbnVJdGVtQ2xhc3MgKycuJysgYXBwLnNpZGViYXIubWVudUl0ZW1IYXNTdWJDbGFzcyArJyAuJysgYXBwLnNpZGViYXIubWVudVN1Ym1lbnVDbGFzcyArJyAuJysgYXBwLnNpZGViYXIubWVudUl0ZW1DbGFzcyArJy4nKyBhcHAuc2lkZWJhci5tZW51SXRlbUhhc1N1YkNsYXNzICsnID4gLicrIGFwcC5zaWRlYmFyLm1lbnVMaW5rQ2xhc3MgKycnKSk7XG5cdGhhbmRsZVNpZGViYXJNZW51VG9nZ2xlKG1lbnVzKTtcbn07XG5cblxuLyogMDQuIEhhbmRsZSBTaWRlYmFyIFNjcm9sbCBNZW1vcnlcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xudmFyIGhhbmRsZVNpZGViYXJTY3JvbGxNZW1vcnkgPSBmdW5jdGlvbigpIHtcblx0aWYgKCFhcHAuaXNNb2JpbGUpIHtcblx0XHR0cnkge1xuXHRcdFx0aWYgKHR5cGVvZihTdG9yYWdlKSAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mKGxvY2FsU3RvcmFnZSkgIT09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHRcdHZhciBlbG0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuJysgYXBwLnNpZGViYXIuY2xhc3MgKycgWycrIGFwcC5zY3JvbGxCYXIuYXR0ciArJ10nKTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmIChlbG0pIHtcblx0XHRcdFx0XHRlbG0ub25zY3JvbGwgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdGxvY2FsU3RvcmFnZS5zZXRJdGVtKGFwcC5zaWRlYmFyLnNjcm9sbEJhci5sb2NhbFN0b3JhZ2UsIHRoaXMuc2Nyb2xsVG9wKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0dmFyIGRlZmF1bHRTY3JvbGwgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShhcHAuc2lkZWJhci5zY3JvbGxCYXIubG9jYWxTdG9yYWdlKTtcblx0XHRcdFx0XHRpZiAoZGVmYXVsdFNjcm9sbCkge1xuXHRcdFx0XHRcdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLicrIGFwcC5zaWRlYmFyLmNsYXNzICsnIFsnKyBhcHAuc2Nyb2xsQmFyLmF0dHIgKyddJykuc2Nyb2xsVG9wID0gZGVmYXVsdFNjcm9sbDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Y29uc29sZS5sb2coZXJyb3IpO1xuXHRcdH1cblx0fVxufTtcblxuXG4vKiAwNS4gSGFuZGxlIFNpZGViYXIgTWluaWZ5XG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbnZhciBoYW5kbGVTaWRlYmFyTWluaWZ5ID0gZnVuY3Rpb24oKSB7XG5cdHZhciBlbG1zID0gW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbJysgYXBwLnNpZGViYXIubWluaWZ5LnRvZ2dsZUF0dHIgKyddJykpO1xuXHRlbG1zLm1hcChmdW5jdGlvbihlbG0pIHtcblx0XHRlbG0ub25jbGljayA9IGZ1bmN0aW9uKGUpIHtcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcblx0XHRcdHZhciB0YXJnZXRFbG0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuJysgYXBwLmNsYXNzKTtcblx0XHRcdFxuXHRcdFx0aWYgKHRhcmdldEVsbSkge1xuXHRcdFx0XHRpZiAodGFyZ2V0RWxtLmNsYXNzTGlzdC5jb250YWlucyhhcHAuc2lkZWJhci5taW5pZnkudG9nZ2xlZENsYXNzKSkge1xuXHRcdFx0XHRcdHRhcmdldEVsbS5jbGFzc0xpc3QucmVtb3ZlKGFwcC5zaWRlYmFyLm1pbmlmeS50b2dnbGVkQ2xhc3MpO1xuXHRcdFx0XHRcdGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKGFwcC5zaWRlYmFyLm1pbmlmeS5sb2NhbFN0b3JhZ2UpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHRhcmdldEVsbS5jbGFzc0xpc3QuYWRkKGFwcC5zaWRlYmFyLm1pbmlmeS50b2dnbGVkQ2xhc3MpO1xuXHRcdFx0XHRcdGxvY2FsU3RvcmFnZS5zZXRJdGVtKGFwcC5zaWRlYmFyLm1pbmlmeS5sb2NhbFN0b3JhZ2UsIHRydWUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fTtcblx0fSk7XG5cdFxuXHRpZiAodHlwZW9mKFN0b3JhZ2UpICE9PSAndW5kZWZpbmVkJykge1xuXHRcdGlmIChsb2NhbFN0b3JhZ2VbYXBwLnNpZGViYXIubWluaWZ5LmxvY2FsU3RvcmFnZV0pIHtcblx0XHRcdHZhciB0YXJnZXRFbG0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuJysgYXBwLmNsYXNzKTtcblx0XHRcdFxuXHRcdFx0aWYgKHRhcmdldEVsbSkge1xuXHRcdFx0XHR0YXJnZXRFbG0uY2xhc3NMaXN0LmFkZChhcHAuc2lkZWJhci5taW5pZnkudG9nZ2xlZENsYXNzKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cbn07XG52YXIgaGFuZGxlU2lkZWJhck1vYmlsZVRvZ2dsZSA9IGZ1bmN0aW9uKCkge1xuXHR2YXIgZWxtcyA9IFtdLnNsaWNlLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnWycrIGFwcC5zaWRlYmFyLm1vYmlsZS50b2dnbGVBdHRyICsnXScpKTtcblx0XG5cdGVsbXMubWFwKGZ1bmN0aW9uKGVsbSkge1xuXHRcdGVsbS5vbmNsaWNrID0gZnVuY3Rpb24oZSkge1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XG5cdFx0XHR2YXIgdGFyZ2V0RWxtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLicrIGFwcC5jbGFzcylcblx0XHRcdFxuXHRcdFx0aWYgKHRhcmdldEVsbSkge1xuXHRcdFx0XHR0YXJnZXRFbG0uY2xhc3NMaXN0LnJlbW92ZShhcHAuc2lkZWJhci5tb2JpbGUuY2xvc2VkQ2xhc3MpO1xuXHRcdFx0XHR0YXJnZXRFbG0uY2xhc3NMaXN0LmFkZChhcHAuc2lkZWJhci5tb2JpbGUudG9nZ2xlZENsYXNzKTtcblx0XHRcdH1cblx0XHR9O1xuXHR9KTtcbn07XG52YXIgaGFuZGxlU2lkZWJhck1vYmlsZURpc21pc3MgPSBmdW5jdGlvbigpIHtcblx0dmFyIGVsbXMgPSBbXS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1snKyBhcHAuc2lkZWJhci5tb2JpbGUuZGlzbWlzc0F0dHIgKyddJykpO1xuXHRcblx0ZWxtcy5tYXAoZnVuY3Rpb24oZWxtKSB7XG5cdFx0ZWxtLm9uY2xpY2sgPSBmdW5jdGlvbihlKSB7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcblx0XHRcdHZhciB0YXJnZXRFbG0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuJysgYXBwLmNsYXNzKVxuXHRcdFx0XG5cdFx0XHRpZiAodGFyZ2V0RWxtKSB7XG5cdFx0XHRcdHRhcmdldEVsbS5jbGFzc0xpc3QucmVtb3ZlKGFwcC5zaWRlYmFyLm1vYmlsZS50b2dnbGVkQ2xhc3MpO1xuXHRcdFx0XHR0YXJnZXRFbG0uY2xhc3NMaXN0LmFkZChhcHAuc2lkZWJhci5tb2JpbGUuY2xvc2VkQ2xhc3MpO1xuXHRcdFx0XHRcblx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdFx0XHR0YXJnZXRFbG0uY2xhc3NMaXN0LnJlbW92ZShhcHAuc2lkZWJhci5tb2JpbGUuY2xvc2VkQ2xhc3MpO1xuXHRcdFx0XHR9LCBhcHAuYW5pbWF0aW9uLnNwZWVkKTtcblx0XHRcdH1cblx0XHR9O1xuXHR9KTtcbn07XG5cblxuLyogMDYuIEhhbmRsZSBTaWRlYmFyIE1pbmlmeSBGbG9hdCBNZW51XG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbnZhciBoYW5kbGVHZXRIaWRkZW5NZW51SGVpZ2h0ID0gZnVuY3Rpb24oZWxtKSB7XG5cdGVsbS5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgJ3Bvc2l0aW9uOiBhYnNvbHV0ZTsgdmlzaWJpbGl0eTogaGlkZGVuOyBkaXNwbGF5OiBibG9jayAhaW1wb3J0YW50Jyk7XG5cdHZhciB0YXJnZXRIZWlnaHQgID0gZWxtLmNsaWVudEhlaWdodDtcblx0ZWxtLnJlbW92ZUF0dHJpYnV0ZSgnc3R5bGUnKTtcblx0cmV0dXJuIHRhcmdldEhlaWdodDtcbn1cbnZhciBoYW5kbGVTaWRlYmFyTWluaWZ5RmxvYXRNZW51Q2xpY2sgPSBmdW5jdGlvbigpIHtcblx0dmFyIGVsbXMgPSBbXS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy4nKyBhcHAuZmxvYXRTdWJtZW51LmNsYXNzICsnIC4nKyBhcHAuc2lkZWJhci5tZW51SXRlbUNsYXNzICsnLicrIGFwcC5zaWRlYmFyLm1lbnVJdGVtSGFzU3ViQ2xhc3MgKycgPiAuJysgYXBwLnNpZGViYXIubWVudUxpbmtDbGFzcykpO1xuXHRpZiAoZWxtcykge1xuXHRcdGVsbXMubWFwKGZ1bmN0aW9uKGVsbSkge1xuXHRcdFx0ZWxtLm9uY2xpY2sgPSBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0dmFyIHRhcmdldEl0ZW0gPSB0aGlzLmNsb3Nlc3QoJy4nICsgYXBwLnNpZGViYXIubWVudUl0ZW1DbGFzcyk7XG5cdFx0XHRcdHZhciB0YXJnZXQgPSB0YXJnZXRJdGVtLnF1ZXJ5U2VsZWN0b3IoJy4nICsgYXBwLnNpZGViYXIubWVudVN1Ym1lbnVDbGFzcyk7XG5cdFx0XHRcdHZhciB0YXJnZXRTdHlsZSA9IGdldENvbXB1dGVkU3R5bGUodGFyZ2V0KTtcblx0XHRcdFx0dmFyIGNsb3NlID0gKHRhcmdldFN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ2Rpc3BsYXknKSAhPSAnbm9uZScpID8gdHJ1ZSA6IGZhbHNlO1xuXHRcdFx0XHR2YXIgZXhwYW5kID0gKHRhcmdldFN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ2Rpc3BsYXknKSAhPSAnbm9uZScpID8gZmFsc2UgOiB0cnVlO1xuXHRcdFx0XHRcblx0XHRcdFx0c2xpZGVUb2dnbGUodGFyZ2V0KTtcblx0XHRcdFx0XG5cdFx0XHRcdHZhciBsb29wSGVpZ2h0ID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0dmFyIHRhcmdldE1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGFwcC5mbG9hdFN1Ym1lbnUuaWQpO1xuXHRcdFx0XHRcdHZhciB0YXJnZXRNZW51QXJyb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGFwcC5mbG9hdFN1Ym1lbnUuYXJyb3cuaWQpO1xuXHRcdFx0XHRcdHZhciB0YXJnZXRNZW51TGluZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXBwLmZsb2F0U3VibWVudS5saW5lLmlkKTtcblx0XHRcdFx0XHR2YXIgdGFyZ2V0SGVpZ2h0ID0gdGFyZ2V0TWVudS5jbGllbnRIZWlnaHQ7XG5cdFx0XHRcdFx0dmFyIHRhcmdldE9mZnNldCA9IHRhcmdldE1lbnUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cdFx0XHRcdFx0dmFyIHRhcmdldE9yaVRvcCA9IHRhcmdldE1lbnUuZ2V0QXR0cmlidXRlKCdkYXRhLW9mZnNldC10b3AnKTtcblx0XHRcdFx0XHR2YXIgdGFyZ2V0TWVudVRvcCA9IHRhcmdldE1lbnUuZ2V0QXR0cmlidXRlKCdkYXRhLW1lbnUtb2Zmc2V0LXRvcCcpO1xuXHRcdFx0XHRcdHZhciB0YXJnZXRUb3AgXHQgPSB0YXJnZXRPZmZzZXQudG9wO1xuXHRcdFx0XHRcdHZhciB3aW5kb3dIZWlnaHQgPSBkb2N1bWVudC5ib2R5LmNsaWVudEhlaWdodDtcblx0XHRcdFx0XHRpZiAoY2xvc2UpIHtcblx0XHRcdFx0XHRcdGlmICh0YXJnZXRUb3AgPiB0YXJnZXRPcmlUb3ApIHtcblx0XHRcdFx0XHRcdFx0dGFyZ2V0VG9wID0gKHRhcmdldFRvcCA+IHRhcmdldE9yaVRvcCkgPyB0YXJnZXRPcmlUb3AgOiB0YXJnZXRUb3A7XG5cdFx0XHRcdFx0XHRcdHRhcmdldE1lbnUuc3R5bGUudG9wID0gdGFyZ2V0VG9wICsgJ3B4Jztcblx0XHRcdFx0XHRcdFx0dGFyZ2V0TWVudS5zdHlsZS5ib3R0b20gPSAnYXV0byc7XG5cdFx0XHRcdFx0XHRcdHRhcmdldE1lbnVBcnJvdy5zdHlsZS50b3AgPSAnMjBweCc7XG5cdFx0XHRcdFx0XHRcdHRhcmdldE1lbnVBcnJvdy5zdHlsZS5ib3R0b20gPSAnYXV0byc7XG5cdFx0XHRcdFx0XHRcdHRhcmdldE1lbnVMaW5lLnN0eWxlLnRvcCA9ICcyMHB4Jztcblx0XHRcdFx0XHRcdFx0dGFyZ2V0TWVudUxpbmUuc3R5bGUuYm90dG9tID0gJ2F1dG8nO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpZiAoZXhwYW5kKSB7XG5cdFx0XHRcdFx0XHRpZiAoKHdpbmRvd0hlaWdodCAtIHRhcmdldFRvcCkgPCB0YXJnZXRIZWlnaHQpIHtcblx0XHRcdFx0XHRcdFx0dmFyIGFycm93Qm90dG9tID0gKHdpbmRvd0hlaWdodCAtIHRhcmdldE1lbnVUb3ApIC0gMjI7XG5cdFx0XHRcdFx0XHRcdHRhcmdldE1lbnUuc3R5bGUudG9wID0gJ2F1dG8nO1xuXHRcdFx0XHRcdFx0XHR0YXJnZXRNZW51LnN0eWxlLmJvdHRvbSA9IDA7XG5cdFx0XHRcdFx0XHRcdHRhcmdldE1lbnVBcnJvdy5zdHlsZS50b3AgPSAnYXV0byc7XG5cdFx0XHRcdFx0XHRcdHRhcmdldE1lbnVBcnJvdy5zdHlsZS5ib3R0b20gPSBhcnJvd0JvdHRvbSArICdweCc7XG5cdFx0XHRcdFx0XHRcdHRhcmdldE1lbnVMaW5lLnN0eWxlLnRvcCA9ICcyMHB4Jztcblx0XHRcdFx0XHRcdFx0dGFyZ2V0TWVudUxpbmUuc3R5bGUuYm90dG9tID0gYXJyb3dCb3R0b20gKyAncHgnO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0dmFyIGZsb2F0U3VibWVudUVsbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXBwLmZsb2F0U3VibWVudS5pZCArICcgLicrIGFwcC5mbG9hdFN1Ym1lbnUuY2xhc3MpO1xuXHRcdFx0XHRcdFx0aWYgKHRhcmdldEhlaWdodCA+IHdpbmRvd0hlaWdodCkge1xuXHRcdFx0XHRcdFx0XHRpZiAoZmxvYXRTdWJtZW51RWxtKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIHNwbGl0Q2xhc3MgPSAoYXBwLmZsb2F0U3VibWVudS5vdmVyZmxvdy5jbGFzcykuc3BsaXQoJyAnKTtcblx0XHRcdFx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHNwbGl0Q2xhc3MubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0XHRcdGZsb2F0U3VibWVudUVsbS5jbGFzc0xpc3QuYWRkKHNwbGl0Q2xhc3NbaV0pO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSwgMSk7XG5cdFx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0Y2xlYXJJbnRlcnZhbChsb29wSGVpZ2h0KTtcblx0XHRcdFx0fSwgYXBwLmFuaW1hdGlvbi5zcGVlZCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cbn1cbnZhciBoYW5kbGVTaWRlYmFyTWluaWZ5RmxvYXRNZW51ID0gZnVuY3Rpb24oKSB7XG5cdHZhciBlbG1zID0gW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuJyArIGFwcC5zaWRlYmFyLmNsYXNzICsgJyAuJysgYXBwLnNpZGViYXIubWVudUNsYXNzICsnID4gLicrIGFwcC5zaWRlYmFyLm1lbnVJdGVtQ2xhc3MgKycuJysgYXBwLnNpZGViYXIubWVudUl0ZW1IYXNTdWJDbGFzcyArJyA+IC4nKyBhcHAuc2lkZWJhci5tZW51TGlua0NsYXNzICsnJykpO1xuXHRpZiAoZWxtcykge1xuXHRcdGVsbXMubWFwKGZ1bmN0aW9uKGVsbSkge1xuXHRcdFx0ZWxtLm9ubW91c2VlbnRlciA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgYXBwRWxtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLicgKyBhcHAuY2xhc3MpO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYgKGFwcEVsbSAmJiBhcHBFbG0uY2xhc3NMaXN0LmNvbnRhaW5zKGFwcC5zaWRlYmFyLm1pbmlmeS50b2dnbGVkQ2xhc3MpKSB7XG5cdFx0XHRcdFx0Y2xlYXJUaW1lb3V0KGFwcC5mbG9hdFN1Ym1lbnUudGltZW91dCk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0dmFyIHRhcmdldE1lbnUgPSB0aGlzLmNsb3Nlc3QoJy4nKyBhcHAuc2lkZWJhci5tZW51SXRlbUNsYXNzKS5xdWVyeVNlbGVjdG9yKCcuJyArIGFwcC5zaWRlYmFyLm1lbnVTdWJtZW51Q2xhc3MpO1xuXHRcdFx0XHRcdGlmIChhcHAuZmxvYXRTdWJtZW51LmRvbSA9PSB0aGlzICYmIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXBwLmZsb2F0U3VibWVudS5jbGFzcykpIHtcblx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0YXBwLmZsb2F0U3VibWVudS5kb20gPSB0aGlzO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHR2YXIgdGFyZ2V0TWVudUh0bWwgPSB0YXJnZXRNZW51LmlubmVySFRNTDtcblx0XHRcdFx0XHRpZiAodGFyZ2V0TWVudUh0bWwpIHtcblx0XHRcdFx0XHRcdHZhciBib2R5U3R5bGUgICAgID0gZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KTtcblx0XHRcdFx0XHRcdHZhciBzaWRlYmFyT2Zmc2V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLicrIGFwcC5zaWRlYmFyLmNsYXNzKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblx0XHRcdFx0XHRcdHZhciBzaWRlYmFyV2lkdGggID0gcGFyc2VJbnQoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLicrIGFwcC5zaWRlYmFyLmNsYXNzKS5jbGllbnRXaWR0aCk7XG5cdFx0XHRcdFx0XHR2YXIgc2lkZWJhclggICAgICA9IChib2R5U3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnZGlyZWN0aW9uJykgIT0gJ3J0bCcpID8gKHNpZGViYXJPZmZzZXQubGVmdCArIHNpZGViYXJXaWR0aCkgOiAoZG9jdW1lbnQuYm9keS5jbGllbnRXaWR0aCAtIHNpZGViYXJPZmZzZXQubGVmdCk7XG5cdFx0XHRcdFx0XHR2YXIgdGFyZ2V0SGVpZ2h0ICA9IGhhbmRsZUdldEhpZGRlbk1lbnVIZWlnaHQodGFyZ2V0TWVudSk7XG5cdFx0XHRcdFx0XHR2YXIgdGFyZ2V0T2Zmc2V0ICA9IHRoaXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cdFx0XHRcdFx0XHR2YXIgdGFyZ2V0VG9wICAgICA9IHRhcmdldE9mZnNldC50b3A7XG5cdFx0XHRcdFx0XHR2YXIgdGFyZ2V0TGVmdCAgICA9IChib2R5U3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnZGlyZWN0aW9uJykgIT0gJ3J0bCcpID8gc2lkZWJhclggOiAnYXV0byc7XG5cdFx0XHRcdFx0XHR2YXIgdGFyZ2V0UmlnaHQgICA9IChib2R5U3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnZGlyZWN0aW9uJykgIT0gJ3J0bCcpID8gJ2F1dG8nIDogc2lkZWJhclg7XG5cdFx0XHRcdFx0XHR2YXIgd2luZG93SGVpZ2h0ICA9IGRvY3VtZW50LmJvZHkuY2xpZW50SGVpZ2h0O1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRpZiAoIWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnKyBhcHAuZmxvYXRTdWJtZW51LmlkKSkge1xuXHRcdFx0XHRcdFx0XHR2YXIgb3ZlcmZsb3dDbGFzcyA9ICcnO1xuXHRcdFx0XHRcdFx0XHRpZiAodGFyZ2V0SGVpZ2h0ID4gd2luZG93SGVpZ2h0KSB7XG5cdFx0XHRcdFx0XHRcdFx0b3ZlcmZsb3dDbGFzcyA9IGFwcC5mbG9hdFN1Ym1lbnUub3ZlcmZsb3cuY2xhc3M7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0dmFyIGh0bWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0XHRcdFx0XHRcdFx0aHRtbC5zZXRBdHRyaWJ1dGUoJ2lkJywgYXBwLmZsb2F0U3VibWVudS5pZCk7XG5cdFx0XHRcdFx0XHRcdGh0bWwuc2V0QXR0cmlidXRlKCdjbGFzcycsIGFwcC5mbG9hdFN1Ym1lbnUuY2xhc3MpO1xuXHRcdFx0XHRcdFx0XHRodG1sLnNldEF0dHJpYnV0ZSgnZGF0YS1vZmZzZXQtdG9wJywgdGFyZ2V0VG9wKTtcblx0XHRcdFx0XHRcdFx0aHRtbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtbWVudS1vZmZzZXQtdG9wJywgdGFyZ2V0VG9wKTtcblx0XHRcdFx0XHRcdFx0aHRtbC5pbm5lckhUTUwgPSAnJytcblx0XHRcdFx0XHRcdFx0J1x0PGRpdiBjbGFzcz1cIicrIGFwcC5mbG9hdFN1Ym1lbnUuY29udGFpbmVyLmNsYXNzICsnICcrIG92ZXJmbG93Q2xhc3MgKydcIj4nKyB0YXJnZXRNZW51SHRtbCArICc8L2Rpdj4nO1xuXHRcdFx0XHRcdFx0XHRhcHBFbG0uYXBwZW5kQ2hpbGQoaHRtbCk7XG5cdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0XHR2YXIgZWxtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYXBwLmZsb2F0U3VibWVudS5pZCk7XG5cdFx0XHRcdFx0XHRcdGVsbS5vbm1vdXNlb3ZlciA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRcdGNsZWFyVGltZW91dChhcHAuZmxvYXRTdWJtZW51LnRpbWVvdXQpO1xuXHRcdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0XHRlbG0ub25tb3VzZW91dCA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRcdGFwcC5mbG9hdFN1Ym1lbnUudGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRcdFx0XHRcdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvcignIycrIGFwcC5mbG9hdFN1Ym1lbnUuaWQpLnJlbW92ZSgpO1xuXHRcdFx0XHRcdFx0XHRcdH0sIGFwcC5hbmltYXRpb24uc3BlZWQpO1xuXHRcdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0dmFyIGZsb2F0U3VibWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnKyBhcHAuZmxvYXRTdWJtZW51LmlkKTtcblx0XHRcdFx0XHRcdFx0dmFyIGZsb2F0U3VibWVudUVsbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnKyBhcHAuZmxvYXRTdWJtZW51LmlkICsgJyAuJysgYXBwLmZsb2F0U3VibWVudS5jb250YWluZXIuY2xhc3MpO1xuXHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0aWYgKHRhcmdldEhlaWdodCA+IHdpbmRvd0hlaWdodCkge1xuXHRcdFx0XHRcdFx0XHRcdGlmIChmbG9hdFN1Ym1lbnVFbG0pIHtcblx0XHRcdFx0XHRcdFx0XHRcdHZhciBzcGxpdENsYXNzID0gKGFwcC5mbG9hdFN1Ym1lbnUub3ZlcmZsb3cuY2xhc3MpLnNwbGl0KCcgJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHNwbGl0Q2xhc3MubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0ZmxvYXRTdWJtZW51RWxtLmNsYXNzTGlzdC5hZGQoc3BsaXRDbGFzc1tpXSk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdGZsb2F0U3VibWVudS5zZXRBdHRyaWJ1dGUoJ2RhdGEtb2Zmc2V0LXRvcCcsIHRhcmdldFRvcCk7XG5cdFx0XHRcdFx0XHRcdGZsb2F0U3VibWVudS5zZXRBdHRyaWJ1dGUoJ2RhdGEtbWVudS1vZmZzZXQtdG9wJywgdGFyZ2V0VG9wKTtcblx0XHRcdFx0XHRcdFx0ZmxvYXRTdWJtZW51RWxtLmlubmVySFRNTCA9IHRhcmdldE1lbnVIdG1sO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0XHRcdHZhciB0YXJnZXRIZWlnaHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJysgYXBwLmZsb2F0U3VibWVudS5pZCkuY2xpZW50SGVpZ2h0O1xuXHRcdFx0XHRcdFx0dmFyIGZsb2F0U3VibWVudUVsbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnKyBhcHAuZmxvYXRTdWJtZW51LmlkKTtcblx0XHRcdFx0XHRcdGlmICgod2luZG93SGVpZ2h0IC0gdGFyZ2V0VG9wKSA+IHRhcmdldEhlaWdodCkge1xuXHRcdFx0XHRcdFx0XHRpZiAoZmxvYXRTdWJtZW51RWxtKSB7XG5cdFx0XHRcdFx0XHRcdFx0ZmxvYXRTdWJtZW51RWxtLnN0eWxlLnRvcCA9IHRhcmdldFRvcCArICdweCc7XG5cdFx0XHRcdFx0XHRcdFx0ZmxvYXRTdWJtZW51RWxtLnN0eWxlLmxlZnQgPSB0YXJnZXRMZWZ0ICsgJ3B4Jztcblx0XHRcdFx0XHRcdFx0XHRmbG9hdFN1Ym1lbnVFbG0uc3R5bGUuYm90dG9tID0gJ2F1dG8nO1xuXHRcdFx0XHRcdFx0XHRcdGZsb2F0U3VibWVudUVsbS5zdHlsZS5yaWdodCA9IHRhcmdldFJpZ2h0ICsgJ3B4Jztcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0dmFyIGFycm93Qm90dG9tID0gKHdpbmRvd0hlaWdodCAtIHRhcmdldFRvcCkgLSAyMTtcblx0XHRcdFx0XHRcdFx0aWYgKGZsb2F0U3VibWVudUVsbSkge1xuXHRcdFx0XHRcdFx0XHRcdGZsb2F0U3VibWVudUVsbS5zdHlsZS50b3AgPSAnYXV0byc7XG5cdFx0XHRcdFx0XHRcdFx0ZmxvYXRTdWJtZW51RWxtLnN0eWxlLmxlZnQgPSB0YXJnZXRMZWZ0ICsgJ3B4Jztcblx0XHRcdFx0XHRcdFx0XHRmbG9hdFN1Ym1lbnVFbG0uc3R5bGUuYm90dG9tID0gMDtcblx0XHRcdFx0XHRcdFx0XHRmbG9hdFN1Ym1lbnVFbG0uc3R5bGUucmlnaHQgPSB0YXJnZXRSaWdodCArICdweCc7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGhhbmRsZVNpZGViYXJNaW5pZnlGbG9hdE1lbnVDbGljaygpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJysgYXBwLmZsb2F0U3VibWVudS5pZCkucmVtb3ZlKCk7XG5cdFx0XHRcdFx0XHRhcHAuZmxvYXRTdWJtZW51LmRvbSA9ICcnO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0ZWxtLm9ubW91c2VsZWF2ZSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgZWxtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLicgKyBhcHAuY2xhc3MpO1xuXHRcdFx0XHRpZiAoZWxtICYmIGVsbS5jbGFzc0xpc3QuY29udGFpbnMoYXBwLnNpZGViYXIubWluaWZ5LnRvZ2dsZWRDbGFzcykpIHtcblx0XHRcdFx0XHRhcHAuZmxvYXRTdWJtZW51LnRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHRcdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnKyBhcHAuZmxvYXRTdWJtZW51LmlkKS5yZW1vdmUoKTtcblx0XHRcdFx0XHRcdGFwcC5mbG9hdFN1Ym1lbnUuZG9tID0gJyc7XG5cdFx0XHRcdFx0fSwgMjUwKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG59O1xuXG5cbi8qIDA3LiBIYW5kbGUgQ2FyZCAtIEV4cGFuZFxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG52YXIgaGFuZGxlQ2FyZEFjdGlvbiA9IGZ1bmN0aW9uKCkge1xuXHRcInVzZSBzdHJpY3RcIjtcblxuXHRpZiAoYXBwLmNhcmQuZXhwYW5kLnN0YXR1cykge1xuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXHRhcHAuY2FyZC5leHBhbmRTdGF0dXMgPSB0cnVlO1xuXG5cdC8vIGV4cGFuZFxuXHR2YXIgZXhwYW5kVG9nZ2xlckxpc3QgPSBbXS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1snKyBhcHAuY2FyZC5leHBhbmQudG9nZ2xlQXR0ciArJ10nKSk7XG5cdHZhciBleHBhbmRUb2dnbGVyVG9vbHRpcExpc3QgPSBleHBhbmRUb2dnbGVyTGlzdC5tYXAoZnVuY3Rpb24gKGV4cGFuZFRvZ2dsZXJFbCkge1xuXHRcdGV4cGFuZFRvZ2dsZXJFbC5vbmNsaWNrID0gZnVuY3Rpb24oZSkge1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFxuXHRcdFx0dmFyIHRhcmdldCA9IHRoaXMuY2xvc2VzdCgnLicrIGFwcC5jYXJkLmNsYXNzKTtcblx0XHRcdHZhciB0YXJnZXRDbGFzcyA9IGFwcC5jYXJkLmV4cGFuZC5jbGFzcztcblxuXHRcdFx0aWYgKGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmNvbnRhaW5zKHRhcmdldENsYXNzKSAmJiB0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKHRhcmdldENsYXNzKSkge1xuXHRcdFx0XHR0YXJnZXQucmVtb3ZlQXR0cmlidXRlKCdzdHlsZScpO1xuXHRcdFx0XHR0YXJnZXQuY2xhc3NMaXN0LnJlbW92ZSh0YXJnZXRDbGFzcyk7XG5cdFx0XHRcdGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnJlbW92ZSh0YXJnZXRDbGFzcyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQodGFyZ2V0Q2xhc3MpO1xuXHRcdFx0XHR0YXJnZXQuY2xhc3NMaXN0LmFkZCh0YXJnZXRDbGFzcyk7XG5cdFx0XHR9XG5cdFx0XG5cdFx0XHR3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3Jlc2l6ZScpKTtcblx0XHR9O1xuXHRcblx0XHRyZXR1cm4gbmV3IGJvb3RzdHJhcC5Ub29sdGlwKGV4cGFuZFRvZ2dsZXJFbCwge1xuXHRcdFx0dGl0bGU6IGFwcC5jYXJkLmV4cGFuZC50b29sdGlwVGV4dCxcblx0XHRcdHBsYWNlbWVudDogJ2JvdHRvbScsXG5cdFx0XHR0cmlnZ2VyOiAnaG92ZXInLFxuXHRcdFx0Y29udGFpbmVyOiAnYm9keSdcblx0XHR9KTtcblx0fSk7XG59O1xuXG5cbi8qIDA4LiBIYW5kbGUgVG9vbHRpcCAmIFBvcG92ZXIgQWN0aXZhdGlvblxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG52YXIgaGFuZGVsVG9vbHRpcFBvcG92ZXJBY3RpdmF0aW9uID0gZnVuY3Rpb24oKSB7XG5cdFwidXNlIHN0cmljdFwiO1xuXHR2YXIgdG9vbHRpcFRyaWdnZXJMaXN0ID0gW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbJysgYXBwLnRvb2x0aXAudG9nZ2xlQXR0ciArJ10nKSlcblx0dmFyIHRvb2x0aXBMaXN0ID0gdG9vbHRpcFRyaWdnZXJMaXN0Lm1hcChmdW5jdGlvbiAodG9vbHRpcFRyaWdnZXJFbCkge1xuXHRcdHJldHVybiBuZXcgYm9vdHN0cmFwLlRvb2x0aXAodG9vbHRpcFRyaWdnZXJFbCk7XG5cdH0pO1xuXHRcblx0dmFyIHBvcG92ZXJUcmlnZ2VyTGlzdCA9IFtdLnNsaWNlLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnWycrIGFwcC5wb3BvdmVyLnRvZ2dsZUF0dHIgKyddJykpXG5cdHZhciBwb3BvdmVyTGlzdCA9IHBvcG92ZXJUcmlnZ2VyTGlzdC5tYXAoZnVuY3Rpb24gKHBvcG92ZXJUcmlnZ2VyRWwpIHtcblx0XHRyZXR1cm4gbmV3IGJvb3RzdHJhcC5Qb3BvdmVyKHBvcG92ZXJUcmlnZ2VyRWwpO1xuXHR9KTtcbn07XG5cblxuLyogMDkuIEhhbmRsZSBTY3JvbGwgdG8gVG9wIEJ1dHRvbiBBY3RpdmF0aW9uXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbnZhciBoYW5kbGVTY3JvbGxUb1RvcEJ1dHRvbiA9IGZ1bmN0aW9uKCkge1xuXHRcInVzZSBzdHJpY3RcIjtcblx0dmFyIGVsbVRyaWdnZXJMaXN0ID0gW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbJysgYXBwLnNjcm9sbFRvcEJ1dHRvbi50b2dnbGVBdHRyICsnXScpKTtcblx0XG5cdGRvY3VtZW50Lm9uc2Nyb2xsID0gZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGRvYyA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtcblx0XHR2YXIgdG90YWxTY3JvbGwgPSAod2luZG93LnBhZ2VZT2Zmc2V0IHx8IGRvYy5zY3JvbGxUb3ApICAtIChkb2MuY2xpZW50VG9wIHx8IDApO1xuXHRcdHZhciBlbG1MaXN0ID0gZWxtVHJpZ2dlckxpc3QubWFwKGZ1bmN0aW9uKGVsbSkge1xuXHRcdFx0aWYgKHRvdGFsU2Nyb2xsID49IDIwMCkge1xuXHRcdFx0XHRpZiAoIWVsbS5jbGFzc0xpc3QuY29udGFpbnMoYXBwLnNjcm9sbFRvcEJ1dHRvbi5zaG93Q2xhc3MpKSB7XG5cdFx0XHRcdFx0ZWxtLmNsYXNzTGlzdC5hZGQoYXBwLnNjcm9sbFRvcEJ1dHRvbi5zaG93Q2xhc3MpO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRlbG0uY2xhc3NMaXN0LnJlbW92ZShhcHAuc2Nyb2xsVG9wQnV0dG9uLnNob3dDbGFzcyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblx0XG5cdHZhciBlbG1MaXN0ID0gZWxtVHJpZ2dlckxpc3QubWFwKGZ1bmN0aW9uKGVsbSkge1xuXHRcdGVsbS5vbmNsaWNrID0gZnVuY3Rpb24oZSkge1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XG5cdFx0XHR3aW5kb3cuc2Nyb2xsVG8oe3RvcDogMCwgYmVoYXZpb3I6ICdzbW9vdGgnfSk7XG5cdFx0fVxuXHR9KTtcbn07XG5cblxuLyogMTAuIEhhbmRsZSBTY3JvbGwgdG9cbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xudmFyIGhhbmRsZVNjcm9sbFRvID0gZnVuY3Rpb24oKSB7XG5cdHZhciBlbG1UcmlnZ2VyTGlzdCA9IFtdLnNsaWNlLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnWycrIGFwcC5zY3JvbGxUby50b2dnbGVBdHRyICsnXScpKTtcblx0dmFyIGVsbUxpc3QgPSBlbG1UcmlnZ2VyTGlzdC5tYXAoZnVuY3Rpb24oZWxtKSB7XG5cdFx0ZWxtLm9uY2xpY2sgPSBmdW5jdGlvbihlKSB7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XG5cdFx0XHR2YXIgdGFyZ2V0QXR0ciA9IChlbG0uZ2V0QXR0cmlidXRlKGFwcC5zY3JvbGxUby50YXJnZXRBdHRyKSkgPyB0aGlzLmdldEF0dHJpYnV0ZShhcHAuc2Nyb2xsVG8udGFyZ2V0QXR0cikgOiB0aGlzLmdldEF0dHJpYnV0ZSgnaHJlZicpO1xuXHRcdFx0dmFyIHRhcmdldEVsbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGFyZ2V0QXR0cilbMF07XG5cdFx0XHR2YXIgdGFyZ2V0SGVhZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLicrIGFwcC5oZWFkZXIuY2xhc3MpWzBdO1xuXHRcdFx0dmFyIHRhcmdldEhlaWdodCA9IHRhcmdldEhlYWRlci5vZmZzZXRIZWlnaHQ7XG5cdFx0XHRpZiAodGFyZ2V0RWxtKSB7XG5cdFx0XHRcdHZhciB0YXJnZXRUb3AgPSB0YXJnZXRFbG0ub2Zmc2V0VG9wIC0gdGFyZ2V0SGVpZ2h0ICsgMzY7XG5cdFx0XHRcdHdpbmRvdy5zY3JvbGxUbyh7dG9wOiB0YXJnZXRUb3AsIGJlaGF2aW9yOiAnc21vb3RoJ30pO1xuXHRcdFx0fVxuXHRcdH1cblx0fSk7XG59O1xuXG5cbi8qIDExLiBIYW5kbGUgVGhlbWUgUGFuZWwgRXhwYW5kXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbnZhciBoYW5kbGVUaGVtZVBhbmVsRXhwYW5kID0gZnVuY3Rpb24oKSB7XG5cdHZhciBlbG1MaXN0ID0gW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbJysgYXBwLnRoZW1lUGFuZWwudG9nZ2xlQXR0ciArJ10nKSk7XG5cdFxuXHRlbG1MaXN0Lm1hcChmdW5jdGlvbihlbG0pIHtcblx0XHRlbG0ub25jbGljayA9IGZ1bmN0aW9uKGUpIHtcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFxuXHRcdFx0dmFyIHRhcmdldENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nKyBhcHAudGhlbWVQYW5lbC5jbGFzcyk7XG5cdFx0XHR2YXIgdGFyZ2V0RXhwYW5kID0gZmFsc2U7XG5cdFx0XG5cdFx0XHRpZiAodGFyZ2V0Q29udGFpbmVyLmNsYXNzTGlzdC5jb250YWlucyhhcHAudGhlbWVQYW5lbC5hY3RpdmVDbGFzcykpIHtcblx0XHRcdFx0dGFyZ2V0Q29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoYXBwLnRoZW1lUGFuZWwuYWN0aXZlQ2xhc3MpO1xuXHRcdFx0XHRzZXRDb29raWUoYXBwLnRoZW1lUGFuZWwuZXhwYW5kQ29va2llLCAnJyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0YXJnZXRDb250YWluZXIuY2xhc3NMaXN0LmFkZChhcHAudGhlbWVQYW5lbC5hY3RpdmVDbGFzcyk7XG5cdFx0XHRcdHNldENvb2tpZShhcHAudGhlbWVQYW5lbC5leHBhbmRDb29raWUsIGFwcC50aGVtZVBhbmVsLmV4cGFuZENvb2tpZVZhbHVlKTtcblx0XHRcdH1cblx0XHR9XG5cdH0pO1xuXHRcblx0aWYgKGdldENvb2tpZShhcHAudGhlbWVQYW5lbC5leHBhbmRDb29raWUpICYmIGdldENvb2tpZShhcHAudGhlbWVQYW5lbC5leHBhbmRDb29raWUpID09IGFwcC50aGVtZVBhbmVsLmV4cGFuZENvb2tpZVZhbHVlKSB7XG5cdFx0dmFyIGVsbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1snKyBhcHAudGhlbWVQYW5lbC50b2dnbGVBdHRyICsnXScpO1xuXHRcdGlmIChlbG0pIHtcblx0XHRcdGVsbS5jbGljaygpO1xuXHRcdH1cblx0fVxufTtcblxuXG4vKiAxMi4gSGFuZGxlIFRoZW1lIFBhZ2UgQ29udHJvbFxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG52YXIgaGFuZGxlVGhlbWVQYWdlQ29udHJvbCA9IGZ1bmN0aW9uKCkge1xuXHQvLyBUaGVtZSBDbGlja1xuXHR2YXIgZWxtcyA9IFtdLnNsaWNlLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLicrIGFwcC50aGVtZVBhbmVsLnRoZW1lTGlzdC5jbGFzcyArJyBbJysgYXBwLnRoZW1lUGFuZWwudGhlbWVMaXN0LnRvZ2dsZUF0dHIgKyddJykpO1xuXHRlbG1zLm1hcChmdW5jdGlvbihlbG0pIHtcblx0XHRlbG0ub25jbGljayA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIHRhcmdldFRoZW1lQ2xhc3MgPSB0aGlzLmdldEF0dHJpYnV0ZShhcHAudGhlbWVQYW5lbC50aGVtZUxpc3QudG9nZ2xlQXR0cik7XG5cdFx0XHRmb3IgKHZhciB4ID0gMDsgeCA8IGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0Lmxlbmd0aDsgeCsrKSB7XG5cdFx0XHRcdHZhciB0YXJnZXRDbGFzcyA9IGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0W3hdO1xuXHRcdFx0XHRpZiAodGFyZ2V0Q2xhc3Muc2VhcmNoKCd0aGVtZS0nKSA+IC0xKSB7XG5cdFx0XHRcdFx0ZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKHRhcmdldENsYXNzKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0aWYgKHRhcmdldFRoZW1lQ2xhc3MpIHtcblx0XHRcdFx0ZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKHRhcmdldFRoZW1lQ2xhc3MpO1xuXHRcdFx0fVxuXHRcdFxuXHRcdFx0dmFyIHRvZ2dsZXJzID0gW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuJysgYXBwLnRoZW1lUGFuZWwudGhlbWVMaXN0LmNsYXNzICsnIFsnKyBhcHAudGhlbWVQYW5lbC50aGVtZUxpc3QudG9nZ2xlQXR0ciArJ10nKSk7XG5cdFx0XHR0b2dnbGVycy5tYXAoZnVuY3Rpb24odG9nZ2xlcikge1xuXHRcdFx0XHRpZiAodG9nZ2xlciAhPSBlbG0pIHtcblx0XHRcdFx0XHR0b2dnbGVyLmNsb3Nlc3QoJ2xpJykuY2xhc3NMaXN0LnJlbW92ZShhcHAudGhlbWVQYW5lbC50aGVtZUxpc3QuYWN0aXZlQ2xhc3MpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHRvZ2dsZXIuY2xvc2VzdCgnbGknKS5jbGFzc0xpc3QuYWRkKGFwcC50aGVtZVBhbmVsLnRoZW1lTGlzdC5hY3RpdmVDbGFzcyk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0aGFuZGxlQ3NzVmFyaWFibGUoKTtcblx0XHRcdHNldENvb2tpZShhcHAudGhlbWVQYW5lbC50aGVtZUxpc3QuY29va2llTmFtZSwgdGFyZ2V0VGhlbWVDbGFzcyk7XG5cdFx0XHRkb2N1bWVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChhcHAudGhlbWVQYW5lbC50aGVtZUxpc3Qub25DaGFuZ2VFdmVudCkpO1xuXHRcdH1cblx0fSk7XG5cdFxuXHQvLyBUaGVtZSBDb29raWVcblx0aWYgKGdldENvb2tpZShhcHAudGhlbWVQYW5lbC50aGVtZUxpc3QuY29va2llTmFtZSkgJiYgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLicrIGFwcC50aGVtZVBhbmVsLnRoZW1lTGlzdC5jbGFzcykpIHtcblx0XHR2YXIgdGFyZ2V0RWxtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLicrIGFwcC50aGVtZVBhbmVsLnRoZW1lTGlzdC5jbGFzcyArJyBbJysgYXBwLnRoZW1lUGFuZWwudGhlbWVMaXN0LnRvZ2dsZUF0dHIgKyc9XCInKyBnZXRDb29raWUoYXBwLnRoZW1lUGFuZWwudGhlbWVMaXN0LmNvb2tpZU5hbWUpICsnXCJdJyk7XG5cdFx0aWYgKHRhcmdldEVsbSkge1xuXHRcdFx0dGFyZ2V0RWxtLmNsaWNrKCk7XG5cdFx0fVxuXHR9XG5cdFxuXHQvLyBEYXJrIE1vZGUgQ2xpY2tcblx0dmFyIGVsbXMgPSBbXS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy4nKyBhcHAudGhlbWVQYW5lbC5jbGFzcyArJyBbbmFtZT1cIicrIGFwcC50aGVtZVBhbmVsLmRhcmtNb2RlLmlucHV0TmFtZSArJ1wiXScpKTtcblx0ZWxtcy5tYXAoZnVuY3Rpb24oZWxtKSB7XG5cdFx0ZWxtLm9uY2hhbmdlID0gZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgdGFyZ2V0Q29va2llID0gJyc7XG5cdFxuXHRcdFx0aWYgKHRoaXMuY2hlY2tlZCkge1xuXHRcdFx0XHRkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLWJzLXRoZW1lJywgJ2RhcmsnKTtcblx0XHRcdFx0dGFyZ2V0Q29va2llID0gJ2RhcmstbW9kZSc7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCdkYXRhLWJzLXRoZW1lJyk7XG5cdFx0XHR9XG5cdFx0XHRoYW5kbGVDc3NWYXJpYWJsZSgpO1xuXHRcdFx0c2V0Q29va2llKGFwcC50aGVtZVBhbmVsLmRhcmtNb2RlLmNvb2tpZU5hbWUsIHRhcmdldENvb2tpZSk7XG5cdFx0XHRkb2N1bWVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChhcHAudGhlbWVQYW5lbC50aGVtZUxpc3Qub25DaGFuZ2VFdmVudCkpO1xuXHRcdH1cblx0fSk7XG5cdFxuXHQvLyBEYXJrIE1vZGUgQ29va2llXG5cdGlmIChnZXRDb29raWUoYXBwLnRoZW1lUGFuZWwuZGFya01vZGUuY29va2llTmFtZSkgJiYgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLicrIGFwcC50aGVtZVBhbmVsLmNsYXNzICsnIFtuYW1lPVwiJysgYXBwLnRoZW1lUGFuZWwuZGFya01vZGUuaW5wdXROYW1lICsnXCJdJykpIHtcblx0XHR2YXIgZWxtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLicrIGFwcC50aGVtZVBhbmVsLmNsYXNzICsnIFtuYW1lPVwiJysgYXBwLnRoZW1lUGFuZWwuZGFya01vZGUuaW5wdXROYW1lICsnXCJdJyk7XG5cdFx0aWYgKGVsbSkge1xuXHRcdFx0ZWxtLmNoZWNrZWQgPSB0cnVlO1xuXHRcdFx0ZWxtLm9uY2hhbmdlKCk7XG5cdFx0fVxuXHR9XG59O1xuXG5cbi8qIDEzLiBIYW5kbGUgQ1NTIFZhcmlhYmxlXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbnZhciBoYW5kbGVDc3NWYXJpYWJsZSA9IGZ1bmN0aW9uKCkge1xuXHR2YXIgcm9vdFN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KTtcblx0XG5cdC8vIGZvbnRcblx0aWYgKGFwcC52YXJpYWJsZUZvbnRMaXN0ICYmIGFwcC52YXJpYWJsZVByZWZpeCkge1xuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgKGFwcC52YXJpYWJsZUZvbnRMaXN0KS5sZW5ndGg7IGkrKykge1xuXHRcdFx0YXBwLmZvbnRbYXBwLnZhcmlhYmxlRm9udExpc3RbaV0ucmVwbGFjZSgvLShbYS16fDAtOV0pL2csIChtYXRjaCwgbGV0dGVyKSA9PiBsZXR0ZXIudG9VcHBlckNhc2UoKSldID0gcm9vdFN0eWxlLmdldFByb3BlcnR5VmFsdWUoJy0tJysgYXBwLnZhcmlhYmxlUHJlZml4ICsgYXBwLnZhcmlhYmxlRm9udExpc3RbaV0pLnRyaW0oKTtcblx0XHR9XG5cdH1cblx0XG5cdC8vIGNvbG9yXG5cdGlmIChhcHAudmFyaWFibGVDb2xvckxpc3QgJiYgYXBwLnZhcmlhYmxlUHJlZml4KSB7XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCAoYXBwLnZhcmlhYmxlQ29sb3JMaXN0KS5sZW5ndGg7IGkrKykge1xuXHRcdFx0YXBwLmNvbG9yW2FwcC52YXJpYWJsZUNvbG9yTGlzdFtpXS5yZXBsYWNlKC8tKFthLXp8MC05XSkvZywgKG1hdGNoLCBsZXR0ZXIpID0+IGxldHRlci50b1VwcGVyQ2FzZSgpKV0gPSByb290U3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnLS0nKyBhcHAudmFyaWFibGVQcmVmaXggKyBhcHAudmFyaWFibGVDb2xvckxpc3RbaV0pLnRyaW0oKTtcblx0XHR9XG5cdH1cbn07XG5cblxuLyogMTQuIEhhbmRsZSBUb2dnbGUgQ2xhc3Ncbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xudmFyIGhhbmRsZVRvZ2dsZUNsYXNzID0gZnVuY3Rpb24oKSB7XG5cdHZhciBlbG1MaXN0ID0gW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbJysgYXBwLnRvZ2dsZUNsYXNzLnRvZ2dsZUF0dHIgKyddJykpO1xuXHRcblx0ZWxtTGlzdC5tYXAoZnVuY3Rpb24oZWxtKSB7XG5cdFx0ZWxtLm9uY2xpY2sgPSBmdW5jdGlvbihlKSB7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcblx0XHRcdHZhciB0YXJnZXRUb2dnbGVDbGFzcyA9IHRoaXMuZ2V0QXR0cmlidXRlKGFwcC50b2dnbGVDbGFzcy50b2dnbGVBdHRyKTtcblx0XHRcdHZhciB0YXJnZXREaXNtaXNzQ2xhc3MgPSB0aGlzLmdldEF0dHJpYnV0ZShhcHAuZGlzbWlzc0NsYXNzLnRvZ2dsZUF0dHIpO1xuXHRcdFx0dmFyIHRhcmdldFRvZ2dsZUVsbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5nZXRBdHRyaWJ1dGUoYXBwLnRvZ2dsZUNsYXNzLnRhcmdldEF0dHIpKTtcblx0XHRcblx0XHRcdGlmICghdGFyZ2V0RGlzbWlzc0NsYXNzKSB7XG5cdFx0XHRcdGlmICh0YXJnZXRUb2dnbGVFbG0uY2xhc3NMaXN0LmNvbnRhaW5zKHRhcmdldFRvZ2dsZUNsYXNzKSkge1xuXHRcdFx0XHRcdHRhcmdldFRvZ2dsZUVsbS5jbGFzc0xpc3QucmVtb3ZlKHRhcmdldFRvZ2dsZUNsYXNzKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR0YXJnZXRUb2dnbGVFbG0uY2xhc3NMaXN0LmFkZCh0YXJnZXRUb2dnbGVDbGFzcyk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGlmICghdGFyZ2V0VG9nZ2xlRWxtLmNsYXNzTGlzdC5jb250YWlucyh0YXJnZXRUb2dnbGVDbGFzcykgJiYgIXRhcmdldFRvZ2dsZUVsbS5jbGFzc0xpc3QuY29udGFpbnModGFyZ2V0RGlzbWlzc0NsYXNzKSkge1xuXHRcdFx0XHRcdGlmICh0YXJnZXRUb2dnbGVFbG0uY2xhc3NMaXN0LmNvbnRhaW5zKHRhcmdldFRvZ2dsZUNsYXNzKSkge1xuXHRcdFx0XHRcdFx0dGFyZ2V0VG9nZ2xlRWxtLmNsYXNzTGlzdC5yZW1vdmUodGFyZ2V0VG9nZ2xlQ2xhc3MpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHR0YXJnZXRUb2dnbGVFbG0uY2xhc3NMaXN0LmFkZCh0YXJnZXRUb2dnbGVDbGFzcyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGlmICh0YXJnZXRUb2dnbGVFbG0uY2xhc3NMaXN0LmNvbnRhaW5zKHRhcmdldFRvZ2dsZUNsYXNzKSkge1xuXHRcdFx0XHRcdFx0dGFyZ2V0VG9nZ2xlRWxtLmNsYXNzTGlzdC5yZW1vdmUodGFyZ2V0VG9nZ2xlQ2xhc3MpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHR0YXJnZXRUb2dnbGVFbG0uY2xhc3NMaXN0LmFkZCh0YXJnZXRUb2dnbGVDbGFzcyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmICh0YXJnZXRUb2dnbGVFbG0uY2xhc3NMaXN0LmNvbnRhaW5zKHRhcmdldERpc21pc3NDbGFzcykpIHtcblx0XHRcdFx0XHRcdHRhcmdldFRvZ2dsZUVsbS5jbGFzc0xpc3QucmVtb3ZlKHRhcmdldERpc21pc3NDbGFzcyk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHRhcmdldFRvZ2dsZUVsbS5jbGFzc0xpc3QuYWRkKHRhcmdldERpc21pc3NDbGFzcyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9KTtcbn1cblxuXG4vKiBBcHBsaWNhdGlvbiBDb250cm9sbGVyXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbnZhciBBcHAgPSBmdW5jdGlvbiAoKSB7XG5cdFwidXNlIHN0cmljdFwiO1xuXHRcblx0cmV0dXJuIHtcblx0XHQvL21haW4gZnVuY3Rpb25cblx0XHRpbml0OiBmdW5jdGlvbiAoKSB7XG5cdFx0XHR0aGlzLmluaXRDb21wb25lbnQoKTtcblx0XHRcdHRoaXMuaW5pdFNpZGViYXIoKTtcblx0XHR9LFxuXHRcdGluaXRTaWRlYmFyOiBmdW5jdGlvbigpIHtcblx0XHRcdGhhbmRsZVNpZGViYXJTY3JvbGxNZW1vcnkoKTtcblx0XHRcdGhhbmRsZVNpZGViYXJNaW5pZnlGbG9hdE1lbnUoKTtcblx0XHRcdGhhbmRsZVNpZGViYXJNZW51KCk7XG5cdFx0XHRoYW5kbGVTaWRlYmFyTWluaWZ5KCk7XG5cdFx0XHRoYW5kbGVTaWRlYmFyTW9iaWxlVG9nZ2xlKCk7XG5cdFx0XHRoYW5kbGVTaWRlYmFyTW9iaWxlRGlzbWlzcygpO1xuXHRcdH0sXG5cdFx0aW5pdENvbXBvbmVudDogZnVuY3Rpb24oKSB7XG5cdFx0XHRoYW5kbGVTY3JvbGxiYXIoKTtcblx0XHRcdGhhbmRsZUNhcmRBY3Rpb24oKTtcblx0XHRcdGhhbmRlbFRvb2x0aXBQb3BvdmVyQWN0aXZhdGlvbigpO1xuXHRcdFx0aGFuZGxlU2Nyb2xsVG9Ub3BCdXR0b24oKTtcblx0XHRcdGhhbmRsZVNjcm9sbFRvKCk7XG5cdFx0XHRoYW5kbGVUaGVtZVBhbmVsRXhwYW5kKCk7XG5cdFx0XHRoYW5kbGVUaGVtZVBhZ2VDb250cm9sKCk7XG5cdFx0XHRoYW5kbGVDc3NWYXJpYWJsZSgpO1xuXHRcdFx0aGFuZGxlVG9nZ2xlQ2xhc3MoKTtcblx0XHR9LFxuXHRcdHNjcm9sbFRvcDogZnVuY3Rpb24oKSB7XG5cdFx0XHR3aW5kb3cuc2Nyb2xsVG8oe3RvcDogMCwgYmVoYXZpb3I6ICdzbW9vdGgnfSk7XG5cdFx0fVxuXHR9O1xufSgpO1xuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24oKSB7XG5cdEFwcC5pbml0KCk7XG59KTsiXX0=
